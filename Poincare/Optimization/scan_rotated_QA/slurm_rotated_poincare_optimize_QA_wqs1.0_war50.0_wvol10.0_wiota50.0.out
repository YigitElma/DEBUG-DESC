/home/ye2698/DESC/desc/integrals/_interp_utils.py:19: UserWarning: 
jax-finufft is not installed.
If you want to use NUFFTs, follow the DESC installation instructions.
Otherwise you must set the parameter nufft_eps to zero
when computing effective ripple, Gamma_c, and any other
computations that involve bounce integrals.

  warnings.warn(
DESC version=0.15.0+425.ga8f1b2dda.
Using JAX backend: jax version=0.6.2, jaxlib version=0.6.2, dtype=float64.
Using device: NVIDIA A100-PCIE-40GB (id=0), with 40.00 GB available memory.
Building objective: QS two-term
Precomputing transforms
Timer: Precomputing transforms = 338 ms
Building objective: aspect ratio
Precomputing transforms
Timer: Precomputing transforms = 40.2 ms
Building objective: volume
Precomputing transforms
Timer: Precomputing transforms = 39.9 ms
Building objective: rotational transform
Precomputing transforms
Timer: Precomputing transforms = 444 ms
Timer: Objective build = 950 ms
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 404 ms
Timer: Objective build = 723 ms
Timer: Objective build = 2.36 ms
Timer: Eq Update LinearConstraintProjection build = 2.45 sec
Timer: Proximal projection build = 29.1 sec
Building objective: fixed cross-section R
Building objective: fixed cross-section Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 284 ms
Timer: LinearConstraintProjection build = 802 ms
Number of parameters: 45
Number of objectives: 478
Timer: Initializing the optimization = 30.3 sec

Starting optimization
Using method: proximal-lsq-exact
Solver options:
------------------------------------------------------------
Maximum Function Evaluations       : 1251
Maximum Allowed Total Î”x Norm      : inf
Scaled Termination                 : True
Trust Region Method                : qr
Initial Trust Radius               : 3.817e+01
Maximum Trust Radius               : inf
Minimum Trust Radius               : 2.220e-16
Trust Radius Increase Ratio        : 2.000e+00
Trust Radius Decrease Ratio        : 2.500e-01
Trust Radius Increase Threshold    : 7.500e-01
Trust Radius Decrease Threshold    : 2.500e-01
------------------------------------------------------------ 

   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          2.094e+02                                    5.485e+00   
       1              4          1.970e+02      1.235e+01      1.511e-03      3.179e+00   
       2              5          1.861e+02      1.095e+01      8.338e-04      1.228e+00   
       3              6          1.762e+02      9.913e+00      1.908e-03      3.379e+00   
       4              7          1.543e+02      2.188e+01      4.440e-03      8.130e+00   
       5              8          1.111e+02      4.318e+01      7.536e-03      3.997e+00   
       6              9          7.569e+01      3.542e+01      1.042e-02      4.893e+00   
       7             10          4.493e+01      3.076e+01      1.207e-02      1.425e+00   
       8             12          3.558e+01      9.356e+00      3.561e-03      1.201e+00   
       9             13          2.665e+01      8.927e+00      1.101e-02      1.960e+00   
      10             15          2.180e+01      4.846e+00      5.397e-03      1.307e+00   
      11             17          1.946e+01      2.344e+00      2.099e-03      5.040e-01   
      12             19          1.858e+01      8.828e-01      1.277e-03      1.214e-01   
      13             20          1.746e+01      1.112e+00      2.696e-03      1.560e-01   
      14             22          1.699e+01      4.723e-01      1.647e-03      2.221e-01   
      15             23          1.652e+01      4.745e-01      3.804e-03      5.637e-01   
      16             24          1.548e+01      1.039e+00      3.888e-03      1.542e-01   
      17             26          1.510e+01      3.795e-01      1.966e-03      7.702e-02   
      18             27          1.449e+01      6.074e-01      4.453e-03      1.337e-01   
      19             29          1.417e+01      3.214e-01      2.334e-03      9.198e-02   
      20             30          1.368e+01      4.915e-01      5.109e-03      1.831e-01   
      21             32          1.338e+01      2.966e-01      2.647e-03      1.475e-01   
      22             33          1.305e+01      3.341e-01      5.615e-03      2.840e-01   
      23             35          1.270e+01      3.479e-01      3.120e-03      7.106e-02   
      24             36          1.252e+01      1.809e-01      6.695e-03      4.982e-01   
      25             37          1.249e+01      2.622e-02      6.945e-03      7.107e-01   
      26             38          1.174e+01      7.581e-01      1.307e-03      6.657e-02   
      27             39          1.149e+01      2.435e-01      3.300e-03      2.274e-01   
      28             40          1.107e+01      4.214e-01      6.719e-03      3.326e-01   
      29             42          1.081e+01      2.628e-01      3.772e-03      3.394e-01   
      30             43          1.043e+01      3.790e-01      3.550e-03      1.826e-01   
      31             44          9.984e+00      4.441e-01      6.604e-03      4.188e-01   
      32             46          9.576e+00      4.086e-01      3.523e-03      1.365e-01   
      33             47          9.358e+00      2.174e-01      6.442e-03      5.827e-01   
      34             48          8.650e+00      7.084e-01      6.106e-03      4.762e-01   
      35             49          8.094e+00      5.561e-01      1.231e-02      1.374e+00   
      36             51          6.392e+00      1.702e+00      2.638e-03      5.310e-01   
      37             52          6.064e+00      3.277e-01      5.638e-03      8.249e-01   
      38             53          5.805e+00      2.591e-01      8.750e-03      1.062e+00   
      39             54          4.643e+00      1.162e+00      2.071e-03      1.473e-01   
      40             56          4.566e+00      7.704e-02      9.365e-04      1.884e-01   
      41             57          4.439e+00      1.275e-01      1.938e-03      2.810e-01   
      42             58          4.391e+00      4.799e-02      3.969e-03      6.383e-01   
      43             59          4.082e+00      3.086e-01      1.019e-03      1.026e-01   
      44             61          4.046e+00      3.637e-02      4.398e-04      8.553e-02   
      45             62          3.991e+00      5.440e-02      9.060e-04      1.556e-01   
      46             64          3.950e+00      4.136e-02      5.302e-04      8.570e-02   
      47             65          3.903e+00      4.722e-02      9.733e-04      1.646e-01   
      48             67          3.861e+00      4.162e-02      5.568e-04      8.743e-02   
      49             68          3.818e+00      4.328e-02      1.003e-03      1.685e-01   
      50             70          3.777e+00      4.043e-02      5.655e-04      9.198e-02   
      51             71          3.736e+00      4.160e-02      1.015e-03      1.676e-01   
      52             73          3.696e+00      3.949e-02      5.646e-04      8.938e-02   
      53             74          3.656e+00      4.048e-02      1.013e-03      1.613e-01   
      54             75          3.639e+00      1.651e-02      2.055e-03      3.613e-01   
      55             76          3.527e+00      1.119e-01      5.530e-04      6.291e-02   
      56             77          3.487e+00      4.079e-02      9.619e-04      1.342e-01   
      57             78          3.430e+00      5.659e-02      2.023e-03      2.570e-01   
      58             79          3.326e+00      1.041e-01      2.087e-03      2.161e-01   
      59             81          3.255e+00      7.133e-02      1.044e-03      9.155e-02   
      60             82          3.212e+00      4.310e-02      2.079e-03      2.417e-01   
      61             83          3.113e+00      9.889e-02      2.211e-03      1.984e-01   
      62             84          3.044e+00      6.828e-02      4.502e-03      4.179e-01   
      63             85          2.955e+00      8.931e-02      4.659e-03      5.149e-01   
      64             86          2.781e+00      1.742e-01      4.740e-03      4.392e-01   
      65             88          2.613e+00      1.675e-01      1.144e-03      5.945e-02   
      66             89          2.568e+00      4.526e-02      2.163e-03      1.939e-01   
      67             90          2.496e+00      7.207e-02      2.181e-03      1.851e-01   
      68             91          2.419e+00      7.748e-02      4.195e-03      3.616e-01   
      69             92          2.374e+00      4.479e-02      4.118e-03      4.914e-01   
      70             93          2.158e+00      2.155e-01      1.019e-03      5.420e-02   
      71             94          2.117e+00      4.142e-02      1.959e-03      2.167e-01   
      72             96          2.057e+00      5.991e-02      1.063e-03      7.210e-02   
      73             97          2.018e+00      3.902e-02      1.976e-03      2.061e-01   
      74             99          1.965e+00      5.261e-02      1.023e-03      8.708e-02   
      75             100         1.945e+00      2.041e-02      1.921e-03      2.732e-01   
      76             101         1.892e+00      5.316e-02      1.924e-03      2.997e-01   
      77             102         1.855e+00      3.660e-02      1.834e-03      3.658e-01   
      78             103         1.810e+00      4.538e-02      1.775e-03      4.084e-01   
      79             104         1.756e+00      5.378e-02      1.804e-03      4.404e-01   
      80             105         1.694e+00      6.166e-02      1.931e-03      4.423e-01   
      81             106         1.630e+00      6.462e-02      2.118e-03      4.257e-01   
      82             107         1.569e+00      6.044e-02      2.296e-03      4.066e-01   
      83             108         1.512e+00      5.693e-02      2.432e-03      3.819e-01   
      84             109         1.456e+00      5.626e-02      2.525e-03      3.451e-01   
      85             110         1.403e+00      5.356e-02      2.572e-03      3.006e-01   
      86             111         1.354e+00      4.886e-02      2.558e-03      2.589e-01   
      87             112         1.312e+00      4.165e-02      2.497e-03      2.398e-01   
      88             113         1.276e+00      3.573e-02      2.449e-03      2.458e-01   
      89             114         1.242e+00      3.428e-02      2.424e-03      2.563e-01   
      90             115         1.205e+00      3.659e-02      2.409e-03      2.509e-01   
      91             116         1.173e+00      3.272e-02      2.406e-03      2.490e-01   
      92             117         1.145e+00      2.741e-02      2.407e-03      2.558e-01   
      93             118         1.120e+00      2.561e-02      2.383e-03      2.625e-01   
      94             119         1.093e+00      2.687e-02      2.349e-03      2.616e-01   
      95             120         1.066e+00      2.714e-02      2.323e-03      2.577e-01   
      96             121         1.039e+00      2.631e-02      2.295e-03      2.540e-01   
      97             122         1.014e+00      2.517e-02      2.257e-03      2.492e-01   
      98             123         9.908e-01      2.345e-02      2.205e-03      2.426e-01   
      99             124         9.690e-01      2.177e-02      2.130e-03      2.323e-01   
      100            125         9.480e-01      2.097e-02      2.032e-03      2.165e-01   
      101            126         9.259e-01      2.217e-02      1.915e-03      1.894e-01   
      102            127         9.035e-01      2.233e-02      1.778e-03      1.533e-01   
      103            128         8.869e-01      1.663e-02      1.624e-03      1.383e-01   
      104            129         8.700e-01      1.693e-02      1.426e-03      1.261e-01   
      105            130         8.522e-01      1.776e-02      1.317e-03      1.261e-01   
      106            131         8.341e-01      1.808e-02      1.320e-03      1.286e-01   
      107            132         8.122e-01      2.190e-02      1.348e-03      1.117e-01   
      108            133         7.890e-01      2.326e-02      1.365e-03      8.808e-02   
      109            134         7.856e-01      3.426e-03      2.859e-03      2.103e-01   
      110            135         7.285e-01      5.708e-02      6.454e-04      3.285e-02   
      111            136         7.189e-01      9.559e-03      1.339e-03      8.477e-02   
      112            137         6.794e-01      3.950e-02      1.467e-03      6.596e-02   
      113            139         6.625e-01      1.688e-02      7.587e-04      3.938e-02   
      114            140         6.544e-01      8.123e-03      1.568e-03      1.026e-01   
      115            141         6.275e-01      2.690e-02      1.612e-03      4.679e-02   
      116            143         6.153e-01      1.220e-02      7.487e-04      2.671e-02   
      117            144         6.072e-01      8.097e-03      1.549e-03      7.580e-02   
      118            145         5.880e-01      1.923e-02      1.554e-03      4.623e-02   
      119            146         5.712e-01      1.675e-02      1.617e-03      4.315e-02   
      120            147         5.540e-01      1.721e-02      1.686e-03      4.575e-02   
      121            148         5.405e-01      1.356e-02      1.785e-03      8.770e-02   
      122            149         5.271e-01      1.332e-02      1.924e-03      1.244e-01   
      123            150         5.114e-01      1.579e-02      2.017e-03      1.371e-01   
      124            151         4.929e-01      1.846e-02      1.986e-03      1.457e-01   
      125            152         4.706e-01      2.225e-02      1.858e-03      1.369e-01   
      126            154         4.522e-01      1.840e-02      4.911e-04      1.872e-02   
      127            155         4.471e-01      5.173e-03      8.968e-04      7.968e-02   
      128            156         4.374e-01      9.676e-03      9.321e-04      7.367e-02   
      129            158         4.304e-01      6.982e-03      4.750e-04      2.578e-02   
      130            159         4.262e-01      4.248e-03      9.135e-04      8.705e-02   
      131            160         4.173e-01      8.867e-03      9.344e-04      7.615e-02   
      132            161         4.108e-01      6.540e-03      9.275e-04      8.649e-02   
      133            162         4.037e-01      7.056e-03      9.258e-04      8.670e-02   
      134            163         3.970e-01      6.686e-03      9.192e-04      8.650e-02   
      135            164         3.906e-01      6.451e-03      9.109e-04      8.446e-02   
      136            165         3.844e-01      6.197e-03      8.998e-04      8.088e-02   
      137            166         3.784e-01      5.962e-03      8.858e-04      7.590e-02   
      138            167         3.727e-01      5.735e-03      8.692e-04      6.989e-02   
      139            168         3.672e-01      5.508e-03      8.512e-04      6.350e-02   
      140            169         3.619e-01      5.292e-03      8.338e-04      5.737e-02   
      141            170         3.568e-01      5.107e-03      8.189e-04      5.196e-02   
      142            171         3.518e-01      4.968e-03      8.079e-04      4.745e-02   
      143            173         3.477e-01      4.066e-03      4.116e-04      7.846e-03   
      144            174         3.447e-01      2.998e-03      7.877e-04      4.901e-02   
      145            175         3.397e-01      5.054e-03      7.981e-04      4.085e-02   
      146            177         3.360e-01      3.650e-03      4.088e-04      8.659e-03   
      147            178         3.324e-01      3.651e-03      7.833e-04      3.541e-02   
      148            180         3.294e-01      2.984e-03      4.084e-04      2.207e-02   
      149            181         3.254e-01      3.956e-03      7.853e-04      3.170e-02   
      150            183         3.226e-01      2.868e-03      4.076e-04      2.201e-02   
      151            184         3.187e-01      3.876e-03      7.835e-04      3.068e-02   
      152            186         3.157e-01      3.009e-03      4.049e-04      9.474e-03   
      153            187         3.122e-01      3.441e-03      7.747e-04      3.291e-02   
      154            189         3.093e-01      2.949e-03      3.993e-04      1.009e-02   
      155            190         3.060e-01      3.335e-03      7.638e-04      3.383e-02   
      156            192         3.031e-01      2.892e-03      3.911e-04      1.071e-02   
      157            193         2.998e-01      3.224e-03      7.482e-04      3.475e-02   
      158            195         2.970e-01      2.854e-03      3.804e-04      1.141e-02   
      159            196         2.939e-01      3.093e-03      7.281e-04      3.668e-02   
      160            198         2.911e-01      2.852e-03      3.674e-04      1.223e-02   
      161            199         2.881e-01      2.939e-03      7.040e-04      3.959e-02   
      162            201         2.852e-01      2.897e-03      3.526e-04      1.307e-02   
      163            202         2.825e-01      2.753e-03      6.769e-04      4.338e-02   
      164            204         2.795e-01      3.002e-03      3.373e-04      1.361e-02   
      165            205         2.772e-01      2.232e-03      6.492e-04      5.234e-02   
      166            206         2.732e-01      4.074e-03      6.297e-04      4.655e-02   
      167            208         2.697e-01      3.502e-03      3.092e-04      1.390e-02   
      168            209         2.681e-01      1.566e-03      6.088e-04      5.934e-02   
      169            211         2.649e-01      3.221e-03      1.520e-04      4.110e-03   
      170            212         2.633e-01      1.543e-03      2.975e-04      2.139e-02   
      171            213         2.619e-01      1.470e-03      6.006e-04      5.844e-02   
      172            214         2.603e-01      1.572e-03      5.998e-04      6.963e-02   
      173            215         2.574e-01      2.880e-03      5.832e-04      8.212e-02   
      174            216         2.524e-01      4.953e-03      5.805e-04      7.491e-02   
      175            217         2.490e-01      3.459e-03      5.841e-04      7.210e-02   
      176            218         2.458e-01      3.181e-03      5.818e-04      7.072e-02   
      177            219         2.410e-01      4.803e-03      5.721e-04      4.987e-02   
      178            220         2.371e-01      3.865e-03      1.090e-03      6.871e-02   
      179            221         2.315e-01      5.591e-03      1.054e-03      7.194e-02   
      180            222         2.262e-01      5.308e-03      9.944e-04      6.999e-02   
      181            223         2.212e-01      5.012e-03      9.495e-04      7.187e-02   
      182            224         2.162e-01      5.057e-03      9.132e-04      6.962e-02   
      183            225         2.112e-01      4.934e-03      8.890e-04      6.785e-02   
      184            226         2.063e-01      4.917e-03      8.707e-04      6.329e-02   
      185            227         2.015e-01      4.832e-03      8.590e-04      5.744e-02   
      186            228         1.968e-01      4.677e-03      8.532e-04      5.109e-02   
      187            230         1.934e-01      3.435e-03      4.374e-04      2.328e-02   
      188            232         1.920e-01      1.380e-03      2.209e-04      1.058e-02   
      189            233         1.905e-01      1.484e-03      4.263e-04      3.131e-02   
      190            234         1.884e-01      2.099e-03      4.304e-04      3.077e-02   
      191            236         1.869e-01      1.553e-03      2.140e-04      1.091e-02   
      192            237         1.855e-01      1.373e-03      4.157e-04      3.191e-02   
      193            238         1.836e-01      1.852e-03      4.149e-04      3.557e-02   
      194            239         1.818e-01      1.871e-03      4.020e-04      3.810e-02   
      195            240         1.799e-01      1.838e-03      3.889e-04      3.971e-02   
      196            241         1.780e-01      1.900e-03      3.738e-04      3.824e-02   
      197            242         1.761e-01      1.884e-03      3.604e-04      3.608e-02   
      198            243         1.743e-01      1.861e-03      3.511e-04      3.312e-02   
      199            245         1.729e-01      1.427e-03      1.744e-04      1.004e-02   
      200            246         1.718e-01      1.096e-03      3.395e-04      2.873e-02   
      201            247         1.705e-01      1.299e-03      3.493e-04      3.372e-02   
      202            248         1.689e-01      1.516e-03      3.593e-04      3.111e-02   
      203            249         1.668e-01      2.105e-03      3.666e-04      2.145e-02   
      204            250         1.658e-01      1.042e-03      7.079e-04      4.807e-02   
      205            251         1.623e-01      3.499e-03      7.011e-04      3.857e-02   
      206            252         1.601e-01      2.180e-03      6.870e-04      4.252e-02   
      207            253         1.571e-01      3.056e-03      6.961e-04      3.912e-02   
      208            254         1.546e-01      2.469e-03      7.121e-04      4.147e-02   
      209            255         1.514e-01      3.183e-03      7.362e-04      3.669e-02   
      210            256         1.490e-01      2.428e-03      7.458e-04      4.575e-02   
      211            257         1.472e-01      1.817e-03      7.440e-04      6.512e-02   
      212            258         1.460e-01      1.149e-03      7.277e-04      8.200e-02   
      213            259         1.411e-01      4.953e-03      1.804e-04      5.657e-03   
      214            261         1.407e-01      3.829e-04      9.925e-05      9.555e-03   
      215            262         1.402e-01      4.348e-04      2.003e-04      1.985e-02   
      216            263         1.397e-01      5.616e-04      2.001e-04      1.958e-02   
      217            264         1.391e-01      5.662e-04      1.969e-04      2.045e-02   
      218            265         1.385e-01      6.060e-04      1.917e-04      1.790e-02   
      219            267         1.381e-01      4.514e-04      9.647e-05      5.317e-03   
      220            268         1.380e-01      4.328e-05      1.818e-04      2.937e-02   
      221            269         1.374e-01      6.345e-04      4.789e-05      4.277e-03   
      222            270         1.372e-01      1.338e-04      9.038e-05      1.555e-02   
Optimization terminated successfully.
`ftol` condition satisfied. (ftol=1.00e-03)
         Current function value: 1.372e-01
         Total delta_x: 3.410e-01
         Iterations: 222
         Function evaluations: 270
         Jacobian evaluations: 223
Timer: Solution time = 10.5 min
Timer: Avg time per step = 2.83 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.991e+02  -->   1.372e-01, 
Maximum absolute Quasi-symmetry (1,0) two-term error:        3.025e-01  -->   8.234e-02 (T^3)
Minimum absolute Quasi-symmetry (1,0) two-term error:        2.532e-05  -->   1.291e-05 (T^3)
Average absolute Quasi-symmetry (1,0) two-term error:        5.511e-02  -->   1.054e-02 (T^3)
Aspect ratio:                                                6.037e+00  -->   6.000e+00 (dimensionless)
Plasma volume:                                               5.420e-01  -->   5.900e-01 (m^3)
Maximum Rotational transform:                                2.750e-02  -->   4.206e-01 (dimensionless)
Minimum Rotational transform:                                2.745e-02  -->   4.183e-01 (dimensionless)
Average Rotational transform:                                2.749e-02  -->   4.197e-01 (dimensionless)
Maximum absolute Force error:                                6.124e-01  -->   6.718e-01 (N)
Minimum absolute Force error:                                1.071e-05  -->   2.403e-06 (N)
Average absolute Force error:                                5.825e-02  -->   1.349e-02 (N)
Maximum absolute Force error:                                2.973e-07  -->   3.262e-07 (normalized)
Minimum absolute Force error:                                5.198e-12  -->   1.166e-12 (normalized)
Average absolute Force error:                                2.828e-08  -->   6.551e-09 (normalized)
Cross-section R error:                                       0.000e+00  -->   0.000e+00 (m)
Cross-section Z error:                                       0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

