/home/ye2698/DESC/desc/integrals/_interp_utils.py:19: UserWarning: 
jax-finufft is not installed.
If you want to use NUFFTs, follow the DESC installation instructions.
Otherwise you must set the parameter nufft_eps to zero
when computing effective ripple, Gamma_c, and any other
computations that involve bounce integrals.

  warnings.warn(
DESC version=0.15.0+424.gdbba9ba17.
Using JAX backend: jax version=0.6.2, jaxlib version=0.6.2, dtype=float64.
Using device: NVIDIA A100-PCIE-40GB (id=0), with 40.00 GB available memory.
Building objective: QS two-term
Precomputing transforms
Timer: Precomputing transforms = 349 ms
Building objective: aspect ratio
Precomputing transforms
Timer: Precomputing transforms = 40.8 ms
Building objective: volume
Precomputing transforms
Timer: Precomputing transforms = 40.8 ms
Building objective: rotational transform
Precomputing transforms
Timer: Precomputing transforms = 304 ms
Timer: Objective build = 826 ms
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 534 ms
Timer: Objective build = 864 ms
Timer: Objective build = 3.21 ms
Timer: Eq Update LinearConstraintProjection build = 2.30 sec
Timer: Proximal projection build = 10.4 sec
Building objective: fixed cross-section R
Building objective: fixed cross-section Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 293 ms
Timer: LinearConstraintProjection build = 854 ms
Number of parameters: 45
Number of objectives: 478
Timer: Initializing the optimization = 11.6 sec

Starting optimization
Using method: proximal-lsq-exact
Solver options:
------------------------------------------------------------
Maximum Function Evaluations       : 1251
Maximum Allowed Total Î”x Norm      : inf
Scaled Termination                 : True
Trust Region Method                : qr
Initial Trust Radius               : 5.672e+02
Maximum Trust Radius               : inf
Minimum Trust Radius               : 2.220e-16
Trust Radius Increase Ratio        : 2.000e+00
Trust Radius Decrease Ratio        : 2.500e-01
Trust Radius Increase Threshold    : 7.500e-01
Trust Radius Decrease Threshold    : 2.500e-01
------------------------------------------------------------ 

   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.172e+04                                    7.642e+01   
       1              4          9.430e+03      2.289e+03      4.276e-03      6.249e+01   
       2              5          7.442e+03      1.989e+03      9.002e-03      3.857e+01   
       3              6          6.482e+03      9.602e+02      9.313e-03      3.659e+01   
       4              7          5.275e+03      1.207e+03      8.083e-03      3.053e+01   
       5              8          3.897e+03      1.378e+03      1.467e-02      2.410e+01   
       6              9          2.493e+03      1.404e+03      1.972e-02      1.030e+01   
       7             10          1.664e+03      8.282e+02      1.893e-02      1.487e+01   
       8             11          1.164e+03      5.004e+02      3.196e-02      7.537e+00   
       9             13          1.076e+03      8.748e+01      5.249e-02      1.022e+01   
      10             14          8.180e+02      2.585e+02      5.340e-02      6.028e+00   
      11             16          8.166e+02      1.447e+00      2.772e-02      7.673e+00   
      12             17          7.251e+02      9.142e+01      4.967e-03      2.360e+00   
      13             18          7.144e+02      1.075e+01      1.512e-02      3.201e+00   
      14             19          6.853e+02      2.913e+01      1.537e-02      2.539e+00   
      15             20          6.703e+02      1.499e+01      1.430e-02      2.655e+00   
      16             21          6.511e+02      1.919e+01      1.334e-02      2.412e+00   
      17             22          6.310e+02      2.010e+01      1.246e-02      2.259e+00   
      18             23          6.033e+02      2.767e+01      1.187e-02      1.777e+00   
      19             24          5.897e+02      1.358e+01      2.101e-02      3.467e+00   
      20             25          5.651e+02      2.467e+01      2.560e-02      3.968e+00   
      21             26          5.193e+02      4.580e+01      2.365e-02      3.949e+00   
      22             27          4.788e+02      4.041e+01      2.074e-02      3.917e+00   
      23             28          4.191e+02      5.979e+01      1.777e-02      1.401e+00   
      24             29          3.756e+02      4.343e+01      1.498e-02      2.116e+00   
      25             30          3.303e+02      4.534e+01      1.311e-02      2.487e+00   
      26             33          2.992e+02      3.111e+01      5.151e-04      1.961e+00   
      27             34          2.779e+02      2.128e+01      9.258e-04      9.778e-01   
      28             36          2.692e+02      8.730e+00      1.562e-03      3.866e-01   
      29             37          2.591e+02      1.002e+01      5.952e-03      1.390e+00   
      30             38          2.576e+02      1.501e+00      1.353e-02      3.989e+00   
      31             39          2.372e+02      2.044e+01      4.816e-03      1.367e+00   
      32             40          2.303e+02      6.918e+00      5.184e-03      1.899e+00   
      33             41          2.216e+02      8.684e+00      5.288e-03      2.820e+00   
      34             42          2.128e+02      8.822e+00      5.919e-03      3.318e+00   
      35             43          2.001e+02      1.265e+01      7.392e-03      2.952e+00   
      36             44          1.922e+02      7.898e+00      8.631e-03      3.394e+00   
      37             45          1.828e+02      9.424e+00      8.107e-03      3.766e+00   
      38             46          1.656e+02      1.720e+01      6.711e-03      2.422e+00   
      39             48          1.559e+02      9.698e+00      3.740e-03      1.564e+00   
      40             49          1.538e+02      2.155e+00      6.127e-03      3.212e+00   
      41             50          1.427e+02      1.103e+01      1.995e-03      5.520e-01   
      42             51          1.400e+02      2.710e+00      3.054e-03      1.562e+00   
      43             52          1.356e+02      4.379e+00      3.369e-03      1.560e+00   
      44             53          1.318e+02      3.870e+00      3.420e-03      1.631e+00   
      45             54          1.280e+02      3.794e+00      3.455e-03      1.660e+00   
      46             55          1.242e+02      3.776e+00      3.455e-03      1.749e+00   
      47             56          1.200e+02      4.229e+00      3.402e-03      1.674e+00   
      48             57          1.154e+02      4.532e+00      3.264e-03      1.556e+00   
      49             58          1.121e+02      3.302e+00      6.053e-03      3.415e+00   
      50             59          9.988e+01      1.225e+01      6.714e-03      2.474e+00   
      51             61          9.040e+01      9.484e+00      3.751e-03      1.359e+00   
      52             63          8.753e+01      2.870e+00      2.022e-03      7.032e-01   
      53             64          8.652e+01      1.002e+00      4.020e-03      2.512e+00   
      54             65          8.242e+01      4.099e+00      4.289e-03      2.264e+00   
      55             66          8.004e+01      2.388e+00      4.323e-03      2.564e+00   
      56             67          7.758e+01      2.453e+00      4.218e-03      2.639e+00   
      57             68          7.657e+01      1.016e+00      3.987e-03      2.822e+00   
      58             69          7.218e+01      4.391e+00      6.790e-04      5.524e-01   
      59             71          7.169e+01      4.885e-01      3.112e-04      6.278e-01   
      60             72          7.113e+01      5.537e-01      4.017e-04      3.500e-01   
      61             73          7.058e+01      5.559e-01      8.621e-04      8.948e-01   
      62             74          6.954e+01      1.034e+00      9.109e-04      6.146e-01   
      63             75          6.925e+01      2.912e-01      1.847e-03      1.538e+00   
      64             76          6.778e+01      1.478e+00      4.340e-04      3.630e-01   
      65             77          6.732e+01      4.542e-01      8.666e-04      9.421e-01   
      66             78          6.659e+01      7.346e-01      9.248e-04      5.503e-01   
      67             79          6.589e+01      6.982e-01      8.892e-04      7.234e-01   
      68             80          6.542e+01      4.732e-01      9.191e-04      6.220e-01   
      69             81          6.466e+01      7.570e-01      9.010e-04      6.520e-01   
      70             82          6.426e+01      3.990e-01      9.276e-04      6.297e-01   
      71             83          6.352e+01      7.404e-01      9.184e-04      6.229e-01   
      72             84          6.316e+01      3.603e-01      9.462e-04      6.246e-01   
      73             85          6.246e+01      6.985e-01      9.431e-04      6.157e-01   
      74             86          6.214e+01      3.207e-01      9.724e-04      6.217e-01   
      75             87          6.149e+01      6.507e-01      9.718e-04      6.213e-01   
      76             88          6.121e+01      2.830e-01      9.980e-04      6.275e-01   
      77             89          6.059e+01      6.114e-01      9.907e-04      6.433e-01   
      78             90          6.033e+01      2.655e-01      1.005e-03      6.366e-01   
      79             91          5.974e+01      5.891e-01      9.813e-04      6.568e-01   
      80             92          5.946e+01      2.753e-01      9.814e-04      6.385e-01   
      81             93          5.889e+01      5.769e-01      9.426e-04      6.549e-01   
      82             94          5.828e+01      6.043e-01      9.342e-04      5.844e-01   
      83             96          5.786e+01      4.272e-01      4.659e-04      2.599e-01   
      84             97          5.785e+01      5.370e-03      8.979e-04      7.958e-01   
      85             98          5.740e+01      4.516e-01      2.162e-04      1.447e-01   
      86             99          5.721e+01      1.852e-01      4.246e-04      4.626e-01   
      87             100         5.687e+01      3.418e-01      4.449e-04      2.705e-01   
      88             101         5.660e+01      2.673e-01      8.476e-04      7.629e-01   
      89             102         5.597e+01      6.390e-01      8.533e-04      5.697e-01   
      90             104         5.557e+01      3.960e-01      4.300e-04      2.835e-01   
      91             105         5.555e+01      2.003e-02      8.359e-04      8.383e-01   
      92             106         5.508e+01      4.738e-01      2.057e-04      1.547e-01   
      93             107         5.492e+01      1.589e-01      4.003e-04      4.817e-01   
      94             108         5.459e+01      3.299e-01      4.222e-04      2.827e-01   
      95             109         5.437e+01      2.149e-01      8.065e-04      7.870e-01   
      96             110         5.375e+01      6.179e-01      8.192e-04      5.835e-01   
      97             112         5.337e+01      3.871e-01      4.171e-04      2.903e-01   
      98             113         5.321e+01      1.566e-01      8.093e-04      8.342e-01   
      99             114         5.272e+01      4.903e-01      8.266e-04      6.717e-01   
      100            115         5.224e+01      4.821e-01      7.873e-04      6.333e-01   
      101            116         5.175e+01      4.921e-01      7.901e-04      5.946e-01   
      102            117         5.131e+01      4.344e-01      7.879e-04      6.259e-01   
      103            118         5.097e+01      3.438e-01      7.879e-04      6.682e-01   
      104            119         5.045e+01      5.193e-01      7.567e-04      5.584e-01   
      105            120         5.042e+01      2.842e-02      1.437e-03      1.321e+00   
      106            121         4.931e+01      1.109e+00      3.750e-04      2.612e-01   
      107            122         4.911e+01      2.040e-01      7.225e-04      7.572e-01   
      108            123         4.848e+01      6.287e-01      7.347e-04      4.515e-01   
      109            124         4.843e+01      4.957e-02      1.380e-03      1.248e+00   
      110            125         4.742e+01      1.008e+00      3.642e-04      2.650e-01   
      111            126         4.718e+01      2.396e-01      6.989e-04      6.866e-01   
      112            127         4.660e+01      5.772e-01      7.063e-04      4.195e-01   
      113            128         4.643e+01      1.781e-01      1.327e-03      1.146e+00   
      114            129         4.557e+01      8.567e-01      3.557e-04      2.381e-01   
      115            130         4.531e+01      2.596e-01      6.810e-04      6.151e-01   
      116            131         4.479e+01      5.179e-01      6.835e-04      4.071e-01   
      117            132         4.454e+01      2.510e-01      1.283e-03      1.073e+00   
      118            133         4.350e+01      1.043e+00      1.288e-03      7.895e-01   
      119            135         4.285e+01      6.494e-01      6.774e-04      3.308e-01   
      120            136         4.259e+01      2.545e-01      1.238e-03      1.018e+00   
      121            137         4.163e+01      9.653e-01      1.215e-03      7.381e-01   
      122            139         4.107e+01      5.635e-01      6.500e-04      3.667e-01   
      123            140         4.085e+01      2.135e-01      1.161e-03      1.011e+00   
      124            141         3.991e+01      9.398e-01      1.119e-03      7.026e-01   
      125            143         3.938e+01      5.285e-01      5.998e-04      3.516e-01   
      126            144         3.911e+01      2.744e-01      1.033e-03      9.208e-01   
      127            145         3.821e+01      8.944e-01      9.700e-04      6.040e-01   
      128            146         3.785e+01      3.670e-01      1.653e-03      1.395e+00   
      129            147         3.617e+01      1.679e+00      1.493e-03      1.010e+00   
      130            148         3.499e+01      1.183e+00      1.158e-03      8.480e-01   
      131            149         3.364e+01      1.341e+00      9.481e-04      9.285e-01   
      132            150         3.201e+01      1.636e+00      6.930e-04      8.583e-01   
      133            151         3.135e+01      6.623e-01      1.332e-03      1.116e+00   
      134            152         2.982e+01      1.528e+00      1.262e-03      1.471e+00   
      135            153         2.905e+01      7.642e-01      1.957e-03      1.769e+00   
      136            154         2.814e+01      9.115e-01      3.127e-03      1.911e+00   
      137            155         2.676e+01      1.380e+00      3.420e-03      2.029e+00   
      138            156         2.590e+01      8.667e-01      3.400e-03      2.169e+00   
      139            157         2.371e+01      2.188e+00      1.718e-03      1.354e+00   
      140            158         2.294e+01      7.710e-01      1.380e-03      9.882e-01   
      141            159         2.243e+01      5.113e-01      1.090e-03      7.515e-01   
      142            160         2.202e+01      4.089e-01      8.365e-04      5.823e-01   
      143            161         2.165e+01      3.688e-01      6.269e-04      4.424e-01   
      144            162         2.107e+01      5.778e-01      6.143e-04      4.783e-01   
      145            163         2.048e+01      5.854e-01      3.752e-04      6.106e-01   
      146            165         1.987e+01      6.146e-01      4.981e-04      8.652e-01   
      147            166         1.936e+01      5.069e-01      5.310e-04      5.168e-01   
      148            167         1.922e+01      1.403e-01      6.565e-04      9.247e-01   
      149            168         1.863e+01      5.928e-01      2.312e-04      1.422e-01   
      150            169         1.843e+01      1.952e-01      2.272e-04      3.985e-01   
      151            170         1.812e+01      3.115e-01      1.372e-04      8.067e-02   
      152            171         1.779e+01      3.319e-01      6.212e-04      4.519e-01   
      153            172         1.753e+01      2.612e-01      1.099e-03      7.208e-01   
      154            173         1.748e+01      4.613e-02      1.533e-03      1.118e+00   
      155            174         1.677e+01      7.182e-01      6.888e-04      3.394e-01   
      156            176         1.665e+01      1.124e-01      3.266e-04      2.203e-01   
      157            177         1.660e+01      5.664e-02      4.396e-04      3.248e-01   
      158            178         1.650e+01      9.686e-02      4.715e-04      3.237e-01   
      159            180         1.643e+01      7.019e-02      3.166e-04      2.220e-01   
      160            181         1.642e+01      1.380e-02      4.679e-04      4.032e-01   
      161            182         1.632e+01      9.220e-02      1.795e-04      1.056e-01   
      162            184         1.631e+01      1.380e-02      9.735e-05      1.220e-01   
Optimization terminated successfully.
`ftol` condition satisfied. (ftol=1.00e-03)
         Current function value: 1.631e+01
         Total delta_x: 8.783e-02
         Iterations: 162
         Function evaluations: 184
         Jacobian evaluations: 163
Timer: Solution time = 5.74 min
Timer: Avg time per step = 2.11 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.166e+04  -->   1.631e+01, 
Maximum absolute Quasi-symmetry (1,0) two-term error:        3.034e-01  -->   1.041e-02 (T^3)
Minimum absolute Quasi-symmetry (1,0) two-term error:        2.375e-05  -->   7.586e-07 (T^3)
Average absolute Quasi-symmetry (1,0) two-term error:        5.504e-02  -->   1.465e-03 (T^3)
Aspect ratio:                                                6.037e+00  -->   5.907e+00 (dimensionless)
Plasma volume:                                               5.420e-01  -->   5.849e-01 (m^3)
Maximum Rotational transform:                                2.750e-02  -->  -2.475e-05 (dimensionless)
Minimum Rotational transform:                                2.745e-02  -->  -8.142e-04 (dimensionless)
Average Rotational transform:                                2.749e-02  -->  -2.804e-04 (dimensionless)
Maximum absolute Force error:                                6.082e-01  -->   1.745e-01 (N)
Minimum absolute Force error:                                3.191e-05  -->   1.686e-07 (N)
Average absolute Force error:                                5.827e-02  -->   2.489e-03 (N)
Maximum absolute Force error:                                2.953e-07  -->   8.472e-08 (normalized)
Minimum absolute Force error:                                1.549e-11  -->   8.185e-14 (normalized)
Average absolute Force error:                                2.829e-08  -->   1.208e-09 (normalized)
Cross-section R error:                                       0.000e+00  -->   0.000e+00 (m)
Cross-section Z error:                                       0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

