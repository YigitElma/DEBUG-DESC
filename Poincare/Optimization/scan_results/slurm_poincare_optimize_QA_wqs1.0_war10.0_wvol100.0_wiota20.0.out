/home/ye2698/DESC/desc/integrals/_interp_utils.py:19: UserWarning: 
jax-finufft is not installed.
If you want to use NUFFTs, follow the DESC installation instructions.
Otherwise you must set the parameter nufft_eps to zero
when computing effective ripple, Gamma_c, and any other
computations that involve bounce integrals.

  warnings.warn(
DESC version=0.15.0+424.gdbba9ba17.
Using JAX backend: jax version=0.6.2, jaxlib version=0.6.2, dtype=float64.
Using device: NVIDIA A100-PCIE-40GB (id=0), with 40.00 GB available memory.
Building objective: QS two-term
Precomputing transforms
Timer: Precomputing transforms = 347 ms
Building objective: aspect ratio
Precomputing transforms
Timer: Precomputing transforms = 40.7 ms
Building objective: volume
Precomputing transforms
Timer: Precomputing transforms = 40.2 ms
Building objective: rotational transform
Precomputing transforms
Timer: Precomputing transforms = 306 ms
Timer: Objective build = 826 ms
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 536 ms
Timer: Objective build = 868 ms
Timer: Objective build = 3.01 ms
Timer: Eq Update LinearConstraintProjection build = 2.29 sec
Timer: Proximal projection build = 10.4 sec
Building objective: fixed cross-section R
Building objective: fixed cross-section Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 293 ms
Timer: LinearConstraintProjection build = 853 ms
Number of parameters: 45
Number of objectives: 478
Timer: Initializing the optimization = 11.6 sec

Starting optimization
Using method: proximal-lsq-exact
Solver options:
------------------------------------------------------------
Maximum Function Evaluations       : 1251
Maximum Allowed Total Î”x Norm      : inf
Scaled Termination                 : True
Trust Region Method                : qr
Initial Trust Radius               : 1.681e+01
Maximum Trust Radius               : inf
Minimum Trust Radius               : 2.220e-16
Trust Radius Increase Ratio        : 2.000e+00
Trust Radius Decrease Ratio        : 2.500e-01
Trust Radius Increase Threshold    : 7.500e-01
Trust Radius Decrease Threshold    : 2.500e-01
------------------------------------------------------------ 

   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          4.383e+01                                    3.947e+00   
       1              4          3.640e+01      7.433e+00      6.049e-03      1.194e+00   
       2              6          3.506e+01      1.339e+00      3.061e-03      1.008e+00   
       3              7          3.472e+01      3.447e-01      5.043e-03      1.022e+00   
       4              8          3.343e+01      1.288e+00      2.613e-03      3.428e-01   
       5             10          3.306e+01      3.717e-01      2.064e-03      2.595e-01   
       6             11          3.293e+01      1.313e-01      4.380e-03      4.348e-01   
       7             12          3.272e+01      2.064e-01      6.706e-03      4.909e-01   
       8             13          3.216e+01      5.578e-01      6.304e-03      2.152e-01   
       9             15          3.207e+01      9.638e-02      2.603e-03      2.023e-01   
      10             16          3.185e+01      2.188e-01      2.250e-03      1.923e-01   
      11             17          3.156e+01      2.876e-01      2.930e-03      2.131e-01   
      12             18          3.095e+01      6.146e-01      6.227e-03      1.628e-01   
      13             19          2.960e+01      1.347e+00      9.678e-03      6.423e-01   
      14             20          2.716e+01      2.435e+00      8.885e-03      3.767e-01   
      15             22          2.522e+01      1.944e+00      7.218e-03      4.069e-01   
      16             25          2.513e+01      9.230e-02      1.876e-03      4.891e-01   
      17             26          2.493e+01      1.953e-01      2.685e-03      3.358e-01   
      18             27          2.470e+01      2.365e-01      1.979e-03      3.129e-01   
      19             28          2.435e+01      3.453e-01      2.905e-03      3.790e-01   
      20             29          2.386e+01      4.895e-01      4.447e-03      7.994e-01   
      21             30          2.269e+01      1.174e+00      7.651e-03      6.940e-01   
      22             32          2.193e+01      7.536e-01      5.273e-03      3.867e-01   
      23             33          2.172e+01      2.140e-01      9.435e-03      1.068e+00   
      24             34          2.089e+01      8.266e-01      3.109e-03      2.119e-01   
      25             35          2.054e+01      3.477e-01      4.438e-03      3.730e-01   
      26             36          1.979e+01      7.512e-01      5.150e-03      4.873e-01   
      27             38          1.933e+01      4.611e-01      1.512e-03      2.325e-01   
      28             39          1.901e+01      3.205e-01      4.560e-03      6.190e-01   
      29             40          1.861e+01      4.060e-01      7.595e-03      6.837e-01   
      30             42          1.818e+01      4.241e-01      2.968e-03      2.728e-01   
      31             43          1.798e+01      1.988e-01      6.108e-03      2.523e-01   
      32             44          1.776e+01      2.186e-01      5.903e-03      1.487e-01   
      33             45          1.753e+01      2.380e-01      6.439e-03      2.554e-01   
      34             46          1.737e+01      1.588e-01      2.551e-03      4.170e-01   
      35             47          1.690e+01      4.687e-01      6.363e-03      2.705e-01   
      36             48          1.613e+01      7.660e-01      7.079e-03      2.284e-01   
      37             49          1.594e+01      1.968e-01      8.291e-03      1.081e+00   
      38             50          1.516e+01      7.759e-01      4.007e-03      5.067e-01   
      39             51          1.452e+01      6.438e-01      6.003e-03      5.353e-01   
      40             53          1.425e+01      2.612e-01      1.491e-03      2.298e-01   
      41             54          1.392e+01      3.344e-01      1.454e-03      1.889e-01   
      42             55          1.334e+01      5.826e-01      3.653e-03      1.042e-01   
      43             56          1.280e+01      5.334e-01      8.770e-03      5.980e-01   
      44             58          1.206e+01      7.408e-01      6.825e-03      2.464e-01   
      45             60          1.188e+01      1.861e-01      2.638e-03      1.974e-01   
      46             61          1.176e+01      1.221e-01      1.824e-03      1.395e-01   
      47             62          1.161e+01      1.465e-01      1.321e-03      9.724e-02   
      48             63          1.135e+01      2.542e-01      2.670e-03      1.228e-01   
      49             64          1.094e+01      4.145e-01      5.495e-03      3.752e-01   
      50             66          1.079e+01      1.534e-01      1.412e-03      1.800e-01   
      51             67          1.064e+01      1.469e-01      2.867e-03      2.695e-01   
      52             68          1.053e+01      1.130e-01      3.220e-03      2.947e-01   
      53             69          1.051e+01      1.629e-02      2.464e-03      3.558e-01   
      54             70          1.047e+01      3.586e-02      2.154e-04      2.301e-01   
      55             71          1.043e+01      4.572e-02      2.846e-04      1.678e-01   
      56             72          1.038e+01      4.686e-02      2.415e-04      1.322e-01   
      57             73          1.028e+01      1.054e-01      5.580e-04      1.174e-01   
      58             74          1.007e+01      2.092e-01      1.680e-03      1.199e-01   
      59             75          9.624e+00      4.435e-01      3.577e-03      2.189e-01   
      60             77          9.273e+00      3.507e-01      8.519e-04      1.995e-01   
      61             78          8.707e+00      5.667e-01      2.598e-03      1.335e-01   
      62             79          8.527e+00      1.800e-01      7.542e-03      7.159e-01   
      63             80          7.964e+00      5.625e-01      6.145e-03      2.294e-01   
      64             82          7.853e+00      1.110e-01      3.193e-03      1.207e-01   
      65             84          7.796e+00      5.695e-02      1.688e-03      1.207e-01   
      66             85          7.726e+00      7.018e-02      3.042e-03      1.163e-01   
      67             86          7.686e+00      4.014e-02      3.054e-03      1.076e-01   
      68             87          7.652e+00      3.360e-02      2.680e-03      1.095e-01   
      69             88          7.630e+00      2.257e-02      2.381e-03      1.228e-01   
      70             89          7.601e+00      2.854e-02      6.291e-04      7.529e-02   
      71             90          7.564e+00      3.773e-02      1.147e-03      7.611e-02   
      72             91          7.550e+00      1.351e-02      2.204e-03      1.327e-01   
      73             92          7.522e+00      2.835e-02      6.871e-04      8.092e-02   
      74             93          7.484e+00      3.741e-02      1.225e-03      7.844e-02   
      75             94          7.460e+00      2.442e-02      2.271e-03      1.144e-01   
      76             95          7.413e+00      4.657e-02      2.299e-03      8.622e-02   
      77             96          7.332e+00      8.172e-02      2.050e-03      8.410e-02   
      78             97          7.152e+00      1.796e-01      3.504e-03      1.476e-01   
      79             98          6.903e+00      2.494e-01      6.701e-03      3.381e-01   
      80             99          6.535e+00      3.672e-01      8.439e-03      2.676e-01   
      81             101         6.322e+00      2.134e-01      6.871e-03      1.948e-01   
      82             102         6.039e+00      2.829e-01      1.007e-02      2.543e-01   
      83             103         5.703e+00      3.356e-01      1.184e-02      4.593e-01   
      84             104         5.102e+00      6.011e-01      1.492e-02      5.080e-01   
      85             106         4.571e+00      5.309e-01      8.436e-03      2.849e-01   
      86             107         4.268e+00      3.038e-01      6.563e-03      4.638e-01   
      87             109         3.959e+00      3.087e-01      5.326e-03      2.014e-01   
      88             110         3.637e+00      3.217e-01      6.928e-03      4.162e-01   
      89             112         3.379e+00      2.582e-01      2.484e-03      2.309e-01   
      90             113         3.123e+00      2.563e-01      4.186e-03      2.788e-01   
      91             114         2.970e+00      1.530e-01      5.102e-03      8.706e-01   
      92             115         2.373e+00      5.967e-01      4.035e-03      1.071e-01   
      93             117         2.298e+00      7.512e-02      1.155e-03      1.243e-01   
      94             118         2.169e+00      1.288e-01      1.334e-03      1.005e-01   
      95             120         2.104e+00      6.530e-02      8.686e-04      3.946e-02   
      96             121         2.018e+00      8.540e-02      1.838e-03      2.094e-01   
      97             122         1.984e+00      3.438e-02      3.449e-03      5.804e-01   
      98             123         1.731e+00      2.532e-01      1.517e-03      1.786e-01   
      99             124         1.596e+00      1.344e-01      2.942e-03      8.992e-02   
      100            126         1.538e+00      5.826e-02      1.400e-03      6.843e-02   
      101            127         1.445e+00      9.281e-02      2.246e-03      4.756e-02   
      102            128         1.355e+00      8.991e-02      3.801e-03      1.590e-01   
      103            129         1.131e+00      2.240e-01      2.946e-03      4.242e-02   
      104            131         9.776e-01      1.538e-01      2.694e-03      6.967e-02   
      105            132         9.769e-01      7.693e-04      2.630e-03      1.734e-01   
      106            133         9.310e-01      4.591e-02      2.669e-03      8.575e-02   
      107            134         8.987e-01      3.220e-02      1.619e-03      4.878e-02   
      108            135         8.683e-01      3.045e-02      8.482e-04      4.599e-02   
      109            136         8.326e-01      3.572e-02      1.012e-03      5.008e-02   
      110            137         7.957e-01      3.688e-02      1.054e-03      5.193e-02   
      111            138         7.251e-01      7.062e-02      7.375e-04      5.180e-02   
      112            139         6.539e-01      7.116e-02      1.992e-03      1.075e-01   
      113            141         6.312e-01      2.268e-02      1.283e-03      1.852e-01   
      114            142         5.941e-01      3.709e-02      4.603e-04      1.594e-01   
      115            144         5.679e-01      2.620e-02      1.541e-04      6.300e-02   
      116            146         5.589e-01      9.064e-03      4.707e-04      1.822e-02   
      117            147         5.557e-01      3.155e-03      6.704e-05      6.264e-02   
      118            148         5.481e-01      7.621e-03      1.992e-04      4.304e-02   
      119            150         5.436e-01      4.483e-03      2.178e-04      1.840e-02   
      120            151         5.421e-01      1.528e-03      2.719e-04      6.181e-02   
      121            152         5.371e-01      5.017e-03      1.970e-04      8.938e-03   
      122            153         5.354e-01      1.692e-03      2.257e-04      2.902e-02   
      123            154         5.327e-01      2.636e-03      2.092e-04      1.745e-02   
      124            155         5.306e-01      2.160e-03      2.089e-04      2.143e-02   
      125            156         5.282e-01      2.335e-03      2.123e-04      1.904e-02   
      126            157         5.260e-01      2.242e-03      2.036e-04      1.905e-02   
      127            158         5.237e-01      2.275e-03      1.973e-04      1.778e-02   
      128            159         5.215e-01      2.260e-03      1.858e-04      1.681e-02   
      129            160         5.192e-01      2.268e-03      1.732e-04      1.541e-02   
      130            161         5.169e-01      2.256e-03      1.576e-04      1.411e-02   
      131            162         5.139e-01      3.020e-03      1.424e-04      1.220e-02   
      132            163         5.094e-01      4.566e-03      1.691e-04      2.382e-02   
      133            164         5.039e-01      5.468e-03      1.594e-04      1.788e-02   
      134            165         5.037e-01      1.641e-04      1.694e-04      9.203e-02   
      135            166         4.965e-01      7.266e-03      2.259e-04      6.718e-03   
      136            167         4.914e-01      5.022e-03      1.832e-04      1.141e-02   
      137            169         4.896e-01      1.872e-03      8.933e-05      8.031e-03   
      138            170         4.876e-01      1.966e-03      7.754e-05      8.647e-03   
      139            171         4.857e-01      1.928e-03      6.137e-05      7.978e-03   
      140            172         4.837e-01      1.948e-03      6.233e-05      7.970e-03   
      141            173         4.791e-01      4.580e-03      6.026e-05      1.370e-02   
      142            174         4.698e-01      9.336e-03      6.572e-05      2.410e-02   
      143            175         4.602e-01      9.567e-03      1.533e-04      6.641e-02   
      144            176         4.489e-01      1.130e-02      5.650e-04      4.850e-02   
      145            177         4.331e-01      1.583e-02      8.990e-04      4.104e-02   
      146            178         4.120e-01      2.107e-02      5.512e-04      2.313e-02   
      147            179         3.933e-01      1.877e-02      4.229e-04      1.706e-01   
      148            180         3.456e-01      4.771e-02      1.094e-03      8.959e-02   
      149            181         3.015e-01      4.401e-02      4.171e-03      3.706e-02   
      150            183         2.748e-01      2.671e-02      1.983e-03      1.059e-01   
      151            185         2.529e-01      2.195e-02      2.898e-04      4.346e-02   
      152            186         2.361e-01      1.675e-02      9.284e-04      1.396e-01   
      153            188         2.201e-01      1.605e-02      7.345e-04      6.242e-02   
      154            190         2.142e-01      5.843e-03      4.352e-04      1.820e-02   
      155            191         2.138e-01      4.029e-04      7.372e-04      7.332e-02   
      156            192         2.088e-01      5.078e-03      4.337e-04      1.690e-02   
      157            193         2.071e-01      1.676e-03      3.213e-04      3.513e-02   
      158            194         2.042e-01      2.930e-03      5.060e-04      1.315e-02   
      159            196         2.029e-01      1.259e-03      2.617e-04      7.351e-03   
      160            197         2.017e-01      1.182e-03      4.156e-04      3.119e-02   
      161            198         1.996e-01      2.136e-03      5.053e-04      2.100e-02   
      162            200         1.983e-01      1.277e-03      2.629e-04      7.244e-03   
      163            201         1.975e-01      8.091e-04      4.002e-04      3.360e-02   
      164            202         1.955e-01      2.035e-03      4.487e-04      2.056e-02   
      165            204         1.943e-01      1.161e-03      2.035e-04      7.576e-03   
      166            205         1.935e-01      8.313e-04      3.616e-04      3.041e-02   
      167            206         1.916e-01      1.835e-03      3.708e-04      1.828e-02   
      168            208         1.906e-01      1.075e-03      1.576e-04      6.617e-03   
      169            209         1.896e-01      9.349e-04      3.245e-04      2.643e-02   
      170            210         1.880e-01      1.655e-03      3.168e-04      1.736e-02   
      171            212         1.869e-01      1.063e-03      1.406e-04      6.049e-03   
      172            213         1.859e-01      9.667e-04      2.963e-04      2.525e-02   
      173            214         1.844e-01      1.578e-03      2.873e-04      1.848e-02   
      174            216         1.833e-01      1.090e-03      1.353e-04      6.614e-03   
      175            217         1.823e-01      9.545e-04      2.775e-04      2.626e-02   
      176            218         1.807e-01      1.564e-03      2.745e-04      2.032e-02   
      177            219         1.807e-01      9.414e-05      5.654e-04      5.604e-02   
      178            220         1.780e-01      2.634e-03      1.252e-04      5.911e-03   
      179            221         1.769e-01      1.148e-03      2.643e-04      2.742e-02   
      180            222         1.751e-01      1.734e-03      2.833e-04      1.970e-02   
      181            223         1.739e-01      1.270e-03      6.124e-04      5.112e-02   
      182            224         1.703e-01      3.608e-03      6.338e-04      3.534e-02   
      183            226         1.685e-01      1.774e-03      3.182e-04      1.529e-02   
      184            227         1.670e-01      1.439e-03      3.153e-04      1.859e-02   
      185            228         1.651e-01      1.975e-03      3.322e-04      1.613e-02   
      186            229         1.642e-01      8.385e-04      7.208e-04      3.700e-02   
      187            230         1.600e-01      4.232e-03      1.647e-04      3.971e-03   
      188            231         1.583e-01      1.652e-03      3.506e-04      1.888e-02   
      189            233         1.570e-01      1.302e-03      1.978e-04      2.933e-03   
      190            234         1.555e-01      1.569e-03      3.710e-04      1.790e-02   
      191            236         1.542e-01      1.273e-03      1.967e-04      2.412e-03   
      192            237         1.527e-01      1.517e-03      3.740e-04      1.704e-02   
      193            239         1.514e-01      1.250e-03      1.958e-04      2.041e-03   
      194            240         1.500e-01      1.469e-03      3.736e-04      1.616e-02   
      195            242         1.487e-01      1.234e-03      1.991e-04      1.896e-03   
      196            243         1.473e-01      1.424e-03      3.762e-04      1.562e-02   
      197            245         1.461e-01      1.244e-03      2.079e-04      2.157e-03   
      198            246         1.447e-01      1.365e-03      3.841e-04      1.590e-02   
      199            248         1.434e-01      1.286e-03      2.200e-04      2.082e-03   
      200            249         1.423e-01      1.071e-03      3.959e-04      1.852e-02   
      201            250         1.412e-01      1.154e-03      4.347e-04      2.381e-02   
      202            251         1.389e-01      2.269e-03      4.235e-04      1.757e-02   
      203            252         1.381e-01      7.795e-04      8.920e-04      4.969e-02   
      204            254         1.354e-01      2.715e-03      1.416e-04      5.337e-03   
      205            255         1.349e-01      5.506e-04      1.241e-04      6.238e-03   
      206            257         1.346e-01      2.335e-04      1.073e-04      1.208e-03   
      207            258         1.342e-01      4.044e-04      1.131e-04      5.302e-03   
      208            259         1.338e-01      4.512e-04      2.280e-04      1.405e-02   
      209            261         1.334e-01      4.163e-04      6.282e-05      1.542e-03   
      210            262         1.330e-01      3.984e-04      1.041e-04      6.051e-03   
      211            264         1.327e-01      2.239e-04      7.247e-05      1.983e-03   
      212            265         1.324e-01      3.885e-04      1.064e-04      5.938e-03   
      213            267         1.321e-01      2.207e-04      6.495e-05      2.188e-03   
      214            268         1.318e-01      3.865e-04      1.035e-04      5.852e-03   
      215            270         1.315e-01      2.190e-04      6.180e-05      2.218e-03   
      216            271         1.314e-01      1.760e-04      1.004e-04      8.432e-03   
      217            297         1.314e-01      0.000e+00      0.000e+00      8.432e-03   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.314e-01
         Total delta_x: 2.686e-01
         Iterations: 217
         Function evaluations: 297
         Jacobian evaluations: 217
Timer: Solution time = 11.4 min
Timer: Avg time per step = 3.16 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      4.379e+01  -->   1.314e-01, 
Maximum absolute Quasi-symmetry (1,0) two-term error:        3.034e-01  -->   7.535e-02 (T^3)
Minimum absolute Quasi-symmetry (1,0) two-term error:        2.375e-05  -->   1.435e-05 (T^3)
Average absolute Quasi-symmetry (1,0) two-term error:        5.504e-02  -->   9.781e-03 (T^3)
Aspect ratio:                                                6.037e+00  -->   6.000e+00 (dimensionless)
Plasma volume:                                               5.420e-01  -->   5.827e-01 (m^3)
Maximum Rotational transform:                                2.750e-02  -->   4.181e-01 (dimensionless)
Minimum Rotational transform:                                2.745e-02  -->   4.147e-01 (dimensionless)
Average Rotational transform:                                2.749e-02  -->   4.165e-01 (dimensionless)
Maximum absolute Force error:                                6.082e-01  -->   1.224e+00 (N)
Minimum absolute Force error:                                3.191e-05  -->   4.141e-06 (N)
Average absolute Force error:                                5.827e-02  -->   2.229e-02 (N)
Maximum absolute Force error:                                2.953e-07  -->   5.942e-07 (normalized)
Minimum absolute Force error:                                1.549e-11  -->   2.010e-12 (normalized)
Average absolute Force error:                                2.829e-08  -->   1.082e-08 (normalized)
Cross-section R error:                                       0.000e+00  -->   0.000e+00 (m)
Cross-section Z error:                                       0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

