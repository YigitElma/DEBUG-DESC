/home/ye2698/DESC/desc/integrals/_interp_utils.py:19: UserWarning: 
jax-finufft is not installed.
If you want to use NUFFTs, follow the DESC installation instructions.
Otherwise you must set the parameter nufft_eps to zero
when computing effective ripple, Gamma_c, and any other
computations that involve bounce integrals.

  warnings.warn(
DESC version=0.15.0+424.gdbba9ba17.
Using JAX backend: jax version=0.6.2, jaxlib version=0.6.2, dtype=float64.
Using device: NVIDIA A100-PCIE-40GB (id=0), with 40.00 GB available memory.
Building objective: QS two-term
Precomputing transforms
Timer: Precomputing transforms = 347 ms
Building objective: aspect ratio
Precomputing transforms
Timer: Precomputing transforms = 39.4 ms
Building objective: volume
Precomputing transforms
Timer: Precomputing transforms = 39.1 ms
Building objective: rotational transform
Precomputing transforms
Timer: Precomputing transforms = 304 ms
Timer: Objective build = 820 ms
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 533 ms
Timer: Objective build = 863 ms
Timer: Objective build = 3.08 ms
Timer: Eq Update LinearConstraintProjection build = 2.28 sec
Timer: Proximal projection build = 10.4 sec
Building objective: fixed cross-section R
Building objective: fixed cross-section Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 291 ms
Timer: LinearConstraintProjection build = 846 ms
Number of parameters: 45
Number of objectives: 478
Timer: Initializing the optimization = 11.6 sec

Starting optimization
Using method: proximal-lsq-exact
Solver options:
------------------------------------------------------------
Maximum Function Evaluations       : 1251
Maximum Allowed Total Î”x Norm      : inf
Scaled Termination                 : True
Trust Region Method                : qr
Initial Trust Radius               : 5.681e+02
Maximum Trust Radius               : inf
Minimum Trust Radius               : 2.220e-16
Trust Radius Increase Ratio        : 2.000e+00
Trust Radius Decrease Ratio        : 2.500e-01
Trust Radius Increase Threshold    : 7.500e-01
Trust Radius Decrease Threshold    : 2.500e-01
------------------------------------------------------------ 

   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.171e+04                                    7.639e+01   
       1              4          9.429e+03      2.284e+03      4.227e-03      6.188e+01   
       2              5          7.440e+03      1.988e+03      9.132e-03      3.756e+01   
       3              6          6.522e+03      9.181e+02      9.883e-03      3.657e+01   
       4              7          5.319e+03      1.203e+03      9.230e-03      3.108e+01   
       5              8          3.993e+03      1.326e+03      2.026e-02      2.664e+01   
       6              9          2.526e+03      1.467e+03      2.894e-02      1.348e+01   
       7             11          2.178e+03      3.481e+02      1.710e-02      1.479e+01   
       8             12          1.832e+03      3.464e+02      1.905e-02      1.279e+01   
       9             13          1.696e+03      1.358e+02      4.284e-02      2.298e+01   
      10             14          1.168e+03      5.276e+02      9.507e-03      7.214e+00   
      11             15          1.016e+03      1.526e+02      2.278e-02      1.143e+01   
      12             16          7.603e+02      2.552e+02      4.358e-02      1.079e+01   
      13             18          5.847e+02      1.756e+02      2.413e-02      4.007e+00   
      14             19          5.540e+02      3.071e+01      3.936e-02      6.758e+00   
      15             20          3.769e+02      1.771e+02      6.369e-03      2.469e+00   
      16             21          3.400e+02      3.693e+01      1.696e-02      5.353e+00   
      17             22          2.700e+02      6.997e+01      1.971e-02      1.666e+00   
      18             24          2.474e+02      2.259e+01      1.072e-02      1.832e+00   
      19             25          2.409e+02      6.519e+00      1.958e-02      3.950e+00   
      20             26          2.126e+02      2.829e+01      4.016e-03      1.239e+00   
      21             27          2.049e+02      7.692e+00      8.607e-03      2.053e+00   
      22             28          1.900e+02      1.492e+01      8.877e-03      1.021e+00   
      23             30          1.834e+02      6.605e+00      4.642e-03      5.532e-01   
      24             31          1.793e+02      4.081e+00      8.969e-03      1.519e+00   
      25             32          1.692e+02      1.012e+01      9.266e-03      9.687e-01   
      26             34          1.633e+02      5.867e+00      4.763e-03      3.603e-01   
      27             35          1.609e+02      2.376e+00      8.973e-03      1.230e+00   
      28             36          1.527e+02      8.178e+00      9.216e-03      6.611e-01   
      29             38          1.486e+02      4.133e+00      4.750e-03      2.931e-01   
      30             39          1.467e+02      1.866e+00      8.624e-03      9.259e-01   
      31             40          1.407e+02      6.008e+00      8.656e-03      4.668e-01   
      32             42          1.378e+02      2.888e+00      4.397e-03      2.254e-01   
      33             43          1.362e+02      1.604e+00      7.355e-03      6.933e-01   
      34             44          1.319e+02      4.342e+00      6.474e-03      3.045e-01   
      35             45          1.299e+02      1.980e+00      8.116e-03      8.563e-01   
      36             46          1.228e+02      7.111e+00      1.326e-03      5.780e-02   
      37             47          1.197e+02      3.063e+00      2.165e-03      4.467e-01   
      38             49          1.137e+02      6.086e+00      5.136e-03      7.606e-02   
      39             50          1.116e+02      2.102e+00      1.019e-02      1.027e+00   
      40             51          1.050e+02      6.576e+00      1.237e-02      1.989e-01   
      41             52          9.892e+01      6.065e+00      2.726e-02      2.570e-01   
      42             54          9.429e+01      4.627e+00      1.519e-02      3.043e-01   
      43             56          9.170e+01      2.591e+00      7.491e-03      1.828e-01   
      44             57          8.995e+01      1.746e+00      1.375e-02      4.123e-01   
      45             58          8.729e+01      2.665e+00      1.291e-02      6.032e-01   
      46             59          8.606e+01      1.230e+00      1.380e-02      8.547e-01   
      47             60          8.056e+01      5.503e+00      3.708e-03      1.893e-01   
      48             61          7.992e+01      6.354e-01      7.356e-03      5.093e-01   
      49             62          7.825e+01      1.665e+00      7.874e-03      4.082e-01   
      50             63          7.700e+01      1.260e+00      7.613e-03      5.042e-01   
      51             64          7.523e+01      1.767e+00      7.371e-03      4.210e-01   
      52             65          7.365e+01      1.576e+00      7.201e-03      4.111e-01   
      53             66          7.199e+01      1.661e+00      7.044e-03      3.509e-01   
      54             67          7.037e+01      1.621e+00      6.889e-03      3.071e-01   
      55             68          6.872e+01      1.654e+00      6.708e-03      2.668e-01   
      56             69          6.728e+01      1.440e+00      1.141e-02      4.507e-01   
      57             70          6.257e+01      4.707e+00      1.220e-02      3.878e-01   
      58             72          5.953e+01      3.034e+00      6.921e-03      2.955e-01   
      59             73          5.801e+01      1.529e+00      1.254e-02      8.991e-01   
      60             74          5.532e+01      2.680e+00      1.127e-02      9.464e-01   
      61             75          5.094e+01      4.389e+00      1.234e-02      7.376e-01   
      62             76          5.066e+01      2.743e-01      1.421e-02      1.144e+00   
      63             77          4.297e+01      7.690e+00      4.115e-03      1.956e-01   
      64             78          4.272e+01      2.484e-01      7.088e-03      6.647e-01   
      65             79          4.031e+01      2.418e+00      2.136e-03      1.426e-01   
      66             80          3.971e+01      5.986e-01      3.373e-03      3.206e-01   
      67             81          3.870e+01      1.002e+00      3.360e-03      2.557e-01   
      68             82          3.812e+01      5.811e-01      5.697e-03      5.862e-01   
      69             83          3.603e+01      2.090e+00      5.582e-03      5.092e-01   
      70             84          3.449e+01      1.544e+00      4.964e-03      5.158e-01   
      71             85          3.305e+01      1.437e+00      4.437e-03      4.811e-01   
      72             86          3.184e+01      1.214e+00      3.829e-03      4.372e-01   
      73             87          3.099e+01      8.529e-01      3.281e-03      4.575e-01   
      74             88          3.055e+01      4.324e-01      3.042e-03      5.861e-01   
      75             90          2.941e+01      1.147e+00      1.024e-03      9.103e-02   
      76             92          2.930e+01      1.102e-01      3.785e-04      1.067e-01   
      77             93          2.917e+01      1.285e-01      6.834e-04      1.954e-01   
      78             94          2.902e+01      1.508e-01      8.502e-04      1.995e-01   
      79             95          2.886e+01      1.541e-01      9.105e-04      2.343e-01   
      80             96          2.872e+01      1.420e-01      1.020e-03      2.436e-01   
      81             97          2.856e+01      1.566e-01      1.061e-03      2.642e-01   
      82             98          2.842e+01      1.428e-01      1.141e-03      2.699e-01   
      83             99          2.826e+01      1.574e-01      1.159e-03      2.851e-01   
      84             100         2.811e+01      1.498e-01      1.210e-03      2.829e-01   
      85             101         2.795e+01      1.618e-01      1.212e-03      2.924e-01   
      86             102         2.779e+01      1.627e-01      1.238e-03      2.796e-01   
      87             103         2.763e+01      1.602e-01      1.222e-03      2.914e-01   
      88             104         2.744e+01      1.884e-01      1.232e-03      2.664e-01   
      89             105         2.727e+01      1.685e-01      1.211e-03      2.612e-01   
      90             106         2.709e+01      1.772e-01      1.210e-03      2.620e-01   
      91             107         2.690e+01      1.911e-01      1.199e-03      2.508e-01   
      92             108         2.673e+01      1.786e-01      1.176e-03      2.456e-01   
      93             109         2.655e+01      1.766e-01      1.183e-03      2.508e-01   
      94             110         2.637e+01      1.809e-01      1.174e-03      2.470e-01   
      95             111         2.619e+01      1.803e-01      1.177e-03      2.489e-01   
      96             112         2.600e+01      1.858e-01      1.173e-03      2.441e-01   
      97             113         2.582e+01      1.807e-01      1.167e-03      2.420e-01   
      98             114         2.565e+01      1.700e-01      1.179e-03      2.494e-01   
      99             115         2.548e+01      1.758e-01      1.172e-03      2.472e-01   
      100            116         2.530e+01      1.722e-01      1.161e-03      2.473e-01   
      101            117         2.514e+01      1.654e-01      1.159e-03      2.473e-01   
      102            118         2.497e+01      1.641e-01      1.135e-03      2.446e-01   
      103            119         2.481e+01      1.605e-01      1.109e-03      2.404e-01   
      104            120         2.465e+01      1.578e-01      1.079e-03      2.373e-01   
      105            121         2.450e+01      1.597e-01      1.034e-03      2.193e-01   
      106            122         2.443e+01      6.823e-02      1.695e-03      4.252e-01   
      107            123         2.409e+01      3.324e-01      5.488e-04      5.911e-02   
      108            124         2.400e+01      9.365e-02      7.086e-04      1.649e-01   
      109            125         2.382e+01      1.860e-01      1.133e-03      2.120e-01   
      110            126         2.343e+01      3.858e-01      1.941e-03      2.145e-01   
      111            128         2.313e+01      3.006e-01      1.329e-03      2.300e-01   
      112            130         2.299e+01      1.368e-01      9.003e-04      1.720e-01   
      113            131         2.296e+01      3.547e-02      1.618e-03      4.380e-01   
      114            132         2.266e+01      2.980e-01      7.155e-04      1.079e-01   
      115            134         2.261e+01      5.286e-02      3.967e-04      8.551e-02   
      116            135         2.257e+01      3.072e-02      5.533e-04      1.617e-01   
      117            136         2.251e+01      6.489e-02      5.846e-04      1.424e-01   
      118            137         2.245e+01      5.981e-02      5.826e-04      1.487e-01   
      119            138         2.239e+01      6.124e-02      5.742e-04      1.474e-01   
      120            139         2.233e+01      6.035e-02      5.690e-04      1.490e-01   
      121            140         2.227e+01      6.032e-02      5.644e-04      1.503e-01   
      122            141         2.221e+01      6.016e-02      5.605e-04      1.521e-01   
      123            142         2.215e+01      6.012e-02      5.569e-04      1.542e-01   
      124            143         2.209e+01      6.010e-02      5.537e-04      1.565e-01   
      125            144         2.203e+01      6.011e-02      5.507e-04      1.592e-01   
      126            145         2.197e+01      6.013e-02      5.480e-04      1.622e-01   
      127            146         2.191e+01      6.016e-02      5.455e-04      1.654e-01   
      128            147         2.185e+01      6.019e-02      5.432e-04      1.689e-01   
      129            148         2.179e+01      6.022e-02      5.413e-04      1.728e-01   
      130            149         2.173e+01      6.023e-02      5.397e-04      1.769e-01   
      131            150         2.167e+01      6.023e-02      5.384e-04      1.814e-01   
      132            151         2.161e+01      6.022e-02      5.376e-04      1.836e-01   
      133            152         2.155e+01      6.017e-02      5.370e-04      1.858e-01   
      134            153         2.149e+01      6.011e-02      5.369e-04      1.881e-01   
      135            154         2.143e+01      6.002e-02      5.371e-04      1.906e-01   
      136            155         2.137e+01      5.988e-02      5.376e-04      1.932e-01   
      137            156         2.129e+01      7.245e-02      5.385e-04      1.958e-01   
      138            158         2.123e+01      6.154e-02      3.394e-04      9.537e-02   
      139            159         2.121e+01      2.197e-02      5.259e-04      2.310e-01   
      140            160         2.115e+01      6.360e-02      5.653e-04      2.027e-01   
      141            161         2.109e+01      5.548e-02      5.734e-04      2.191e-01   
      142            162         2.103e+01      5.746e-02      5.735e-04      2.186e-01   
      143            163         2.098e+01      5.515e-02      5.782e-04      2.239e-01   
      144            164         2.093e+01      5.332e-02      5.814e-04      2.295e-01   
      145            165         2.087e+01      5.306e-02      5.878e-04      2.331e-01   
      146            166         2.082e+01      5.181e-02      5.936e-04      2.368e-01   
      147            167         2.077e+01      5.055e-02      5.996e-04      2.403e-01   
      148            168         2.072e+01      4.924e-02      6.057e-04      2.436e-01   
      149            169         2.067e+01      4.794e-02      6.117e-04      2.465e-01   
      150            170         2.063e+01      4.669e-02      6.173e-04      2.491e-01   
      151            171         2.058e+01      4.551e-02      6.223e-04      2.512e-01   
      152            172         2.054e+01      4.445e-02      6.263e-04      2.526e-01   
      153            173         2.049e+01      4.352e-02      6.290e-04      2.533e-01   
      154            174         2.045e+01      4.273e-02      6.300e-04      2.530e-01   
      155            175         2.041e+01      4.208e-02      6.290e-04      2.518e-01   
      156            176         2.037e+01      4.157e-02      6.259e-04      2.496e-01   
      157            177         2.032e+01      4.118e-02      6.204e-04      2.462e-01   
      158            178         2.028e+01      4.087e-02      6.126e-04      2.418e-01   
      159            179         2.024e+01      4.063e-02      6.024e-04      2.363e-01   
      160            180         2.020e+01      4.041e-02      5.899e-04      2.298e-01   
      161            181         2.016e+01      4.020e-02      5.754e-04      2.225e-01   
      162            182         2.012e+01      3.997e-02      5.590e-04      2.144e-01   
      163            183         2.008e+01      3.970e-02      5.412e-04      2.057e-01   
      164            184         2.004e+01      3.938e-02      5.222e-04      1.966e-01   
      165            185         2.000e+01      3.900e-02      5.025e-04      1.872e-01   
      166            186         1.997e+01      3.856e-02      4.825e-04      1.778e-01   
      167            187         1.993e+01      3.806e-02      4.626e-04      1.686e-01   
      168            188         1.989e+01      3.752e-02      4.431e-04      1.596e-01   
      169            189         1.985e+01      3.694e-02      4.245e-04      1.511e-01   
      170            190         1.982e+01      3.634e-02      4.070e-04      1.431e-01   
      171            191         1.978e+01      3.611e-02      3.922e-04      1.347e-01   
      172            192         1.975e+01      3.512e-02      3.769e-04      1.283e-01   
      173            193         1.971e+01      3.452e-02      3.637e-04      1.226e-01   
      174            194         1.968e+01      3.394e-02      3.523e-04      1.177e-01   
      175            195         1.964e+01      3.339e-02      3.426e-04      1.135e-01   
      176            196         1.961e+01      3.286e-02      3.346e-04      1.102e-01   
      177            197         1.958e+01      3.236e-02      3.281e-04      1.075e-01   
      178            198         1.955e+01      3.188e-02      3.230e-04      1.055e-01   
      179            199         1.952e+01      3.143e-02      3.192e-04      1.041e-01   
      180            200         1.948e+01      3.102e-02      3.166e-04      1.032e-01   
      181            201         1.945e+01      3.063e-02      3.149e-04      1.027e-01   
      182            202         1.942e+01      3.026e-02      3.141e-04      1.026e-01   
      183            203         1.939e+01      2.993e-02      3.138e-04      1.028e-01   
      184            204         1.936e+01      2.961e-02      3.139e-04      1.032e-01   
      185            205         1.933e+01      2.932e-02      3.144e-04      1.037e-01   
      186            206         1.931e+01      2.905e-02      3.150e-04      1.043e-01   
      187            207         1.928e+01      2.879e-02      3.156e-04      1.048e-01   
      188            208         1.925e+01      2.855e-02      3.160e-04      1.053e-01   
      189            209         1.922e+01      2.832e-02      3.162e-04      1.057e-01   
      190            210         1.919e+01      2.810e-02      3.162e-04      1.059e-01   
      191            211         1.916e+01      2.788e-02      3.157e-04      1.060e-01   
      192            212         1.914e+01      2.767e-02      3.148e-04      1.058e-01   
      193            213         1.911e+01      2.745e-02      3.134e-04      1.054e-01   
      194            214         1.908e+01      2.722e-02      3.115e-04      1.047e-01   
      195            215         1.905e+01      2.698e-02      3.091e-04      1.038e-01   
      196            216         1.902e+01      3.343e-02      5.151e-04      1.836e-01   
      197            217         1.895e+01      7.040e-02      5.462e-04      1.761e-01   
      198            218         1.894e+01      7.883e-03      1.096e-03      3.904e-01   
      199            219         1.882e+01      1.191e-01      6.974e-04      2.161e-01   
      200            220         1.878e+01      4.265e-02      5.852e-04      2.123e-01   
      201            221         1.874e+01      3.954e-02      5.282e-04      1.849e-01   
      202            222         1.871e+01      3.599e-02      4.854e-04      1.679e-01   
      203            223         1.867e+01      3.346e-02      4.471e-04      1.512e-01   
      204            224         1.864e+01      3.115e-02      4.146e-04      1.372e-01   
      205            225         1.861e+01      2.921e-02      3.865e-04      1.249e-01   
      206            226         1.858e+01      2.752e-02      3.622e-04      1.141e-01   
      207            227         1.856e+01      2.602e-02      3.411e-04      1.045e-01   
      208            228         1.853e+01      2.468e-02      3.226e-04      9.592e-02   
      209            229         1.851e+01      2.346e-02      3.061e-04      8.813e-02   
      210            230         1.849e+01      2.234e-02      2.913e-04      8.097e-02   
      211            231         1.847e+01      2.131e-02      2.776e-04      7.428e-02   
      212            232         1.845e+01      2.035e-02      2.646e-04      6.793e-02   
      213            233         1.843e+01      1.946e-02      2.520e-04      6.181e-02   
      214            234         1.841e+01      1.866e-02      2.394e-04      5.585e-02   
      215            235         1.839e+01      1.793e-02      2.265e-04      4.998e-02   
Optimization terminated successfully.
`ftol` condition satisfied. (ftol=1.00e-03)
         Current function value: 1.839e+01
         Total delta_x: 8.566e-02
         Iterations: 215
         Function evaluations: 235
         Jacobian evaluations: 216
Timer: Solution time = 6.75 min
Timer: Avg time per step = 1.87 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.165e+04  -->   1.839e+01, 
Maximum absolute Quasi-symmetry (1,0) two-term error:        3.034e-01  -->   1.205e-02 (T^3)
Minimum absolute Quasi-symmetry (1,0) two-term error:        2.375e-05  -->   5.606e-06 (T^3)
Average absolute Quasi-symmetry (1,0) two-term error:        5.504e-02  -->   1.267e-03 (T^3)
Aspect ratio:                                                6.037e+00  -->   6.000e+00 (dimensionless)
Plasma volume:                                               5.420e-01  -->   8.771e-01 (m^3)
Maximum Rotational transform:                                2.750e-02  -->   5.330e-04 (dimensionless)
Minimum Rotational transform:                                2.745e-02  -->   2.441e-05 (dimensionless)
Average Rotational transform:                                2.749e-02  -->   2.161e-04 (dimensionless)
Maximum absolute Force error:                                6.082e-01  -->   5.201e-01 (N)
Minimum absolute Force error:                                3.191e-05  -->   1.535e-07 (N)
Average absolute Force error:                                5.827e-02  -->   5.925e-03 (N)
Maximum absolute Force error:                                2.953e-07  -->   2.525e-07 (normalized)
Minimum absolute Force error:                                1.549e-11  -->   7.453e-14 (normalized)
Average absolute Force error:                                2.829e-08  -->   2.877e-09 (normalized)
Cross-section R error:                                       0.000e+00  -->   0.000e+00 (m)
Cross-section Z error:                                       0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

