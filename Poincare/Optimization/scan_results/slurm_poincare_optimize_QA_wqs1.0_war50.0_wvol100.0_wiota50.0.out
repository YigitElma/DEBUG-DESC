/home/ye2698/DESC/desc/integrals/_interp_utils.py:19: UserWarning: 
jax-finufft is not installed.
If you want to use NUFFTs, follow the DESC installation instructions.
Otherwise you must set the parameter nufft_eps to zero
when computing effective ripple, Gamma_c, and any other
computations that involve bounce integrals.

  warnings.warn(
DESC version=0.15.0+424.gdbba9ba17.
Using JAX backend: jax version=0.6.2, jaxlib version=0.6.2, dtype=float64.
Using device: NVIDIA A100-PCIE-40GB (id=0), with 40.00 GB available memory.
Building objective: QS two-term
Precomputing transforms
Timer: Precomputing transforms = 340 ms
Building objective: aspect ratio
Precomputing transforms
Timer: Precomputing transforms = 40.4 ms
Building objective: volume
Precomputing transforms
Timer: Precomputing transforms = 39.8 ms
Building objective: rotational transform
Precomputing transforms
Timer: Precomputing transforms = 297 ms
Timer: Objective build = 807 ms
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 527 ms
Timer: Objective build = 848 ms
Timer: Objective build = 2.98 ms
Timer: Eq Update LinearConstraintProjection build = 2.25 sec
Timer: Proximal projection build = 10.2 sec
Building objective: fixed cross-section R
Building objective: fixed cross-section Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 286 ms
Timer: LinearConstraintProjection build = 843 ms
Number of parameters: 45
Number of objectives: 478
Timer: Initializing the optimization = 11.4 sec

Starting optimization
Using method: proximal-lsq-exact
Solver options:
------------------------------------------------------------
Maximum Function Evaluations       : 1251
Maximum Allowed Total Î”x Norm      : inf
Scaled Termination                 : True
Trust Region Method                : qr
Initial Trust Radius               : 3.650e+01
Maximum Trust Radius               : inf
Minimum Trust Radius               : 2.220e-16
Trust Radius Increase Ratio        : 2.000e+00
Trust Radius Decrease Ratio        : 2.500e-01
Trust Radius Increase Threshold    : 7.500e-01
Trust Radius Decrease Threshold    : 2.500e-01
------------------------------------------------------------ 

   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          2.073e+02                                    4.336e+00   
       1              4          2.073e+02      5.784e-02      4.973e-03      4.580e+00   
       2              5          1.985e+02      8.789e+00      1.355e-04      1.865e+00   
       3              6          1.941e+02      4.393e+00      8.098e-04      1.006e+00   
       4              7          1.904e+02      3.706e+00      2.465e-03      1.468e+00   
       5              8          1.826e+02      7.753e+00      5.250e-03      1.757e+00   
       6              9          1.668e+02      1.578e+01      1.007e-02      1.754e+00   
       7             11          1.523e+02      1.452e+01      5.653e-03      1.750e+00   
       8             12          1.407e+02      1.163e+01      2.155e-02      1.838e+00   
       9             13          1.331e+02      7.546e+00      1.421e-02      4.777e+00   
      10             15          1.174e+02      1.574e+01      4.712e-03      1.031e+00   
      11             17          1.149e+02      2.463e+00      2.454e-03      1.152e+00   
      12             18          1.105e+02      4.423e+00      4.713e-03      1.198e+00   
      13             19          1.032e+02      7.319e+00      7.285e-03      1.004e+00   
      14             21          9.877e+01      4.431e+00      2.704e-03      7.871e-01   
      15             22          9.321e+01      5.557e+00      3.916e-03      9.940e-01   
      16             24          8.909e+01      4.123e+00      3.257e-03      6.392e-01   
      17             25          8.454e+01      4.551e+00      5.833e-03      8.038e-01   
      18             26          7.637e+01      8.173e+00      1.062e-02      2.790e+00   
      19             27          6.725e+01      9.118e+00      1.120e-02      4.221e+00   
      20             28          5.867e+01      8.576e+00      7.832e-03      4.035e+00   
      21             29          5.217e+01      6.498e+00      1.779e-02      4.451e+00   
      22             30          3.044e+01      2.173e+01      3.411e-02      6.677e-01   
      23             32          2.640e+01      4.038e+00      1.635e-02      2.885e-01   
      24             34          2.521e+01      1.188e+00      3.400e-03      3.207e-01   
      25             35          2.344e+01      1.768e+00      8.131e-03      2.955e-01   
      26             37          2.281e+01      6.316e-01      3.844e-03      1.528e-01   
      27             38          2.206e+01      7.565e-01      2.461e-03      1.498e-01   
      28             39          2.092e+01      1.133e+00      4.564e-03      1.934e-01   
      29             40          1.962e+01      1.306e+00      4.147e-03      1.634e-01   
      30             41          1.785e+01      1.769e+00      1.104e-02      4.048e-01   
      31             42          1.524e+01      2.610e+00      1.493e-02      6.824e-01   
      32             44          1.385e+01      1.392e+00      9.585e-03      1.643e-01   
      33             46          1.332e+01      5.263e-01      4.454e-03      1.918e-01   
      34             47          1.267e+01      6.463e-01      8.681e-03      4.737e-01   
      35             48          1.215e+01      5.269e-01      1.143e-02      5.349e-01   
      36             49          1.172e+01      4.272e-01      1.245e-02      7.328e-01   
      37             50          1.100e+01      7.169e-01      1.285e-02      7.522e-01   
      38             51          1.052e+01      4.858e-01      1.257e-02      1.023e+00   
      39             52          9.181e+00      1.335e+00      1.027e-02      5.728e-01   
      40             54          8.495e+00      6.858e-01      5.107e-03      2.408e-01   
      41             55          7.787e+00      7.079e-01      8.205e-03      5.062e-01   
      42             57          7.554e+00      2.327e-01      5.968e-03      5.723e-01   
      43             58          7.482e+00      7.219e-02      5.132e-03      2.600e-01   
      44             59          7.270e+00      2.118e-01      1.069e-03      2.702e-01   
      45             60          7.043e+00      2.272e-01      2.687e-03      3.453e-01   
      46             61          6.746e+00      2.976e-01      2.991e-03      2.870e-01   
      47             62          6.330e+00      4.152e-01      5.773e-03      3.791e-01   
      48             63          5.837e+00      4.939e-01      8.950e-03      4.517e-01   
      49             65          5.510e+00      3.264e-01      3.571e-03      9.233e-02   
      50             66          5.361e+00      1.495e-01      5.703e-03      5.155e-01   
      51             67          4.990e+00      3.704e-01      6.976e-03      4.882e-01   
      52             68          4.771e+00      2.188e-01      5.940e-03      4.459e-01   
      53             70          4.487e+00      2.842e-01      2.362e-03      7.640e-02   
      54             71          4.355e+00      1.319e-01      2.498e-03      9.273e-02   
      55             72          4.115e+00      2.404e-01      3.929e-03      1.623e-01   
      56             73          4.006e+00      1.089e-01      7.642e-03      3.565e-01   
      57             74          3.531e+00      4.753e-01      3.890e-03      9.644e-02   
      58             76          3.506e+00      2.525e-02      9.652e-04      1.392e-01   
      59             77          3.416e+00      8.971e-02      1.403e-03      1.352e-01   
      60             78          3.364e+00      5.211e-02      3.400e-03      2.367e-01   
      61             79          3.278e+00      8.585e-02      3.643e-03      1.454e-01   
      62             80          3.215e+00      6.255e-02      2.656e-03      9.386e-02   
      63             81          3.128e+00      8.690e-02      1.828e-03      1.296e-01   
      64             82          3.006e+00      1.221e-01      1.518e-03      1.204e-01   
      65             83          2.933e+00      7.370e-02      3.207e-03      2.035e-01   
      66             85          2.826e+00      1.066e-01      1.492e-03      4.966e-02   
      67             86          2.788e+00      3.817e-02      2.373e-03      9.301e-02   
      68             87          2.723e+00      6.503e-02      2.270e-03      7.960e-02   
      69             88          2.626e+00      9.664e-02      2.050e-03      9.374e-02   
      70             89          2.509e+00      1.167e-01      2.062e-03      1.162e-01   
      71             90          2.427e+00      8.236e-02      3.571e-03      4.154e-01   
      72             91          2.372e+00      5.474e-02      4.024e-03      3.422e-01   
      73             92          2.250e+00      1.226e-01      1.540e-03      4.486e-02   
      74             93          2.190e+00      5.979e-02      1.969e-03      1.364e-01   
      75             94          2.119e+00      7.129e-02      2.007e-03      8.503e-02   
      76             95          2.023e+00      9.597e-02      2.965e-03      1.247e-01   
      77             96          2.021e+00      1.328e-03      2.796e-03      1.213e-01   
      78             97          1.917e+00      1.040e-01      4.314e-04      5.817e-02   
      79             98          1.850e+00      6.693e-02      5.427e-04      4.174e-02   
      80             99          1.766e+00      8.459e-02      1.601e-03      1.411e-01   
      81             100         1.654e+00      1.117e-01      1.616e-03      1.856e-01   
      82             101         1.568e+00      8.608e-02      5.415e-04      1.444e-01   
      83             103         1.500e+00      6.857e-02      1.713e-04      6.930e-02   
      84             104         1.496e+00      3.790e-03      3.684e-04      1.261e-01   
      85             105         1.452e+00      4.402e-02      7.835e-05      2.057e-02   
      86             106         1.426e+00      2.582e-02      1.407e-04      3.952e-02   
      87             108         1.407e+00      1.914e-02      7.803e-05      2.138e-02   
      88             109         1.382e+00      2.494e-02      1.241e-04      4.177e-02   
      89             111         1.363e+00      1.926e-02      8.949e-05      2.155e-02   
      90             112         1.338e+00      2.491e-02      1.457e-04      4.394e-02   
      91             113         1.337e+00      9.121e-04      5.092e-04      1.287e-01   
      92             114         1.293e+00      4.409e-02      2.679e-04      1.422e-02   
      93             115         1.267e+00      2.611e-02      4.101e-04      4.594e-02   
      94             116         1.266e+00      1.359e-04      1.138e-03      1.169e-01   
      95             117         1.236e+00      3.020e-02      6.749e-04      7.885e-02   
      96             118         1.215e+00      2.073e-02      8.410e-04      9.621e-02   
      97             119         1.194e+00      2.118e-02      1.074e-03      8.329e-02   
      98             120         1.173e+00      2.125e-02      9.489e-04      6.419e-02   
      99             121         1.151e+00      2.242e-02      7.753e-04      2.287e-02   
      100            122         1.135e+00      1.560e-02      5.168e-04      5.634e-02   
      101            123         1.106e+00      2.864e-02      3.814e-04      1.611e-02   
      102            124         1.077e+00      2.932e-02      7.888e-04      5.900e-02   
      103            125         1.010e+00      6.663e-02      1.834e-03      5.461e-02   
      104            126         8.960e-01      1.144e-01      3.801e-03      4.613e-02   
      105            128         8.519e-01      4.407e-02      2.422e-03      9.162e-02   
      106            129         7.969e-01      5.505e-02      3.722e-03      3.511e-01   
      107            130         7.952e-01      1.708e-03      3.838e-03      2.485e-01   
      108            131         6.674e-01      1.278e-01      9.076e-04      2.927e-02   
      109            132         6.365e-01      3.093e-02      1.945e-03      1.086e-01   
      110            133         6.056e-01      3.086e-02      1.985e-03      8.609e-02   
      111            134         5.810e-01      2.465e-02      1.831e-03      1.098e-01   
      112            135         5.522e-01      2.879e-02      2.096e-03      9.257e-02   
      113            136         5.307e-01      2.143e-02      1.838e-03      1.158e-01   
      114            137         5.049e-01      2.583e-02      1.644e-03      5.935e-02   
      115            139         4.982e-01      6.739e-03      8.079e-04      3.778e-02   
      116            140         4.900e-01      8.172e-03      6.817e-04      2.757e-02   
      117            141         4.847e-01      5.310e-03      6.946e-04      3.242e-02   
      118            142         4.817e-01      2.955e-03      6.755e-04      4.270e-02   
      119            143         4.761e-01      5.615e-03      1.385e-04      1.854e-02   
      120            144         4.757e-01      4.608e-04      1.523e-04      1.440e-02   
      121            170         4.757e-01      0.000e+00      0.000e+00      1.440e-02   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 4.757e-01
         Total delta_x: 2.876e-01
         Iterations: 121
         Function evaluations: 170
         Jacobian evaluations: 121
Timer: Solution time = 6.67 min
Timer: Avg time per step = 3.28 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      2.072e+02  -->   4.757e-01, 
Maximum absolute Quasi-symmetry (1,0) two-term error:        3.034e-01  -->   1.196e-01 (T^3)
Minimum absolute Quasi-symmetry (1,0) two-term error:        2.375e-05  -->   2.219e-05 (T^3)
Average absolute Quasi-symmetry (1,0) two-term error:        5.504e-02  -->   1.831e-02 (T^3)
Aspect ratio:                                                6.037e+00  -->   6.000e+00 (dimensionless)
Plasma volume:                                               5.420e-01  -->   5.829e-01 (m^3)
Maximum Rotational transform:                                2.750e-02  -->   4.197e-01 (dimensionless)
Minimum Rotational transform:                                2.745e-02  -->   4.164e-01 (dimensionless)
Average Rotational transform:                                2.749e-02  -->   4.185e-01 (dimensionless)
Maximum absolute Force error:                                6.082e-01  -->   7.979e-01 (N)
Minimum absolute Force error:                                3.191e-05  -->   1.279e-05 (N)
Average absolute Force error:                                5.827e-02  -->   2.045e-02 (N)
Maximum absolute Force error:                                2.953e-07  -->   3.874e-07 (normalized)
Minimum absolute Force error:                                1.549e-11  -->   6.211e-12 (normalized)
Average absolute Force error:                                2.829e-08  -->   9.929e-09 (normalized)
Cross-section R error:                                       0.000e+00  -->   0.000e+00 (m)
Cross-section Z error:                                       0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

