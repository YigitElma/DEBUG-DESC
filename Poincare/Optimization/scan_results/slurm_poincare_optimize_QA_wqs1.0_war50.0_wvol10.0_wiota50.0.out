/home/ye2698/DESC/desc/integrals/_interp_utils.py:19: UserWarning: 
jax-finufft is not installed.
If you want to use NUFFTs, follow the DESC installation instructions.
Otherwise you must set the parameter nufft_eps to zero
when computing effective ripple, Gamma_c, and any other
computations that involve bounce integrals.

  warnings.warn(
DESC version=0.15.0+424.gdbba9ba17.
Using JAX backend: jax version=0.6.2, jaxlib version=0.6.2, dtype=float64.
Using device: NVIDIA A100-PCIE-40GB (id=0), with 40.00 GB available memory.
Building objective: QS two-term
Precomputing transforms
Timer: Precomputing transforms = 339 ms
Building objective: aspect ratio
Precomputing transforms
Timer: Precomputing transforms = 39.7 ms
Building objective: volume
Precomputing transforms
Timer: Precomputing transforms = 39.6 ms
Building objective: rotational transform
Precomputing transforms
Timer: Precomputing transforms = 298 ms
Timer: Objective build = 805 ms
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 523 ms
Timer: Objective build = 840 ms
Timer: Objective build = 2.95 ms
Timer: Eq Update LinearConstraintProjection build = 2.23 sec
Timer: Proximal projection build = 10.1 sec
Building objective: fixed cross-section R
Building objective: fixed cross-section Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 280 ms
Timer: LinearConstraintProjection build = 829 ms
Number of parameters: 45
Number of objectives: 478
Timer: Initializing the optimization = 11.3 sec

Starting optimization
Using method: proximal-lsq-exact
Solver options:
------------------------------------------------------------
Maximum Function Evaluations       : 1251
Maximum Allowed Total Î”x Norm      : inf
Scaled Termination                 : True
Trust Region Method                : qr
Initial Trust Radius               : 3.497e+01
Maximum Trust Radius               : inf
Minimum Trust Radius               : 2.220e-16
Trust Radius Increase Ratio        : 2.000e+00
Trust Radius Decrease Ratio        : 2.500e-01
Trust Radius Increase Threshold    : 7.500e-01
Trust Radius Decrease Threshold    : 2.500e-01
------------------------------------------------------------ 

   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.991e+02                                    2.262e+00   
       1              4          1.934e+02      5.715e+00      3.347e-03      2.464e+00   
       2              6          1.897e+02      3.690e+00      1.289e-03      8.878e-01   
       3              7          1.872e+02      2.539e+00      3.487e-03      1.124e+00   
       4              8          1.821e+02      5.136e+00      3.180e-03      1.124e+00   
       5             10          1.793e+02      2.797e+00      1.036e-03      1.416e+00   
       6             11          1.730e+02      6.218e+00      1.876e-03      1.254e+00   
       7             12          1.616e+02      1.144e+01      5.461e-03      2.856e+00   
       8             13          1.382e+02      2.343e+01      1.339e-02      3.111e+00   
       9             14          1.145e+02      2.365e+01      3.023e-02      4.752e+00   
      10             16          8.893e+01      2.559e+01      3.374e-03      3.447e+00   
      11             17          7.117e+01      1.776e+01      1.132e-02      1.313e+00   
      12             18          5.912e+01      1.205e+01      1.526e-02      3.893e+00   
      13             19          3.724e+01      2.187e+01      8.671e-03      1.189e+00   
      14             20          2.754e+01      9.707e+00      2.389e-02      1.827e+00   
      15             21          2.193e+01      5.604e+00      1.481e-02      1.670e+00   
      16             22          1.985e+01      2.088e+00      1.470e-02      2.713e+00   
      17             23          1.463e+01      5.219e+00      2.063e-02      2.020e+00   
      18             24          1.117e+01      3.459e+00      2.833e-02      7.741e-01   
      19             25          1.025e+01      9.201e-01      2.612e-02      6.192e-01   
      20             27          9.015e+00      1.233e+00      6.714e-04      3.970e-01   
      21             28          7.925e+00      1.090e+00      1.192e-03      1.797e-01   
      22             29          6.656e+00      1.269e+00      1.764e-03      3.088e-01   
      23             30          5.523e+00      1.133e+00      2.071e-02      4.864e-01   
      24             31          4.761e+00      7.614e-01      5.010e-02      7.103e-01   
      25             32          3.596e+00      1.165e+00      5.358e-02      6.553e-01   
      26             33          3.397e+00      1.996e-01      4.903e-02      4.689e-01   
      27             34          3.287e+00      1.100e-01      3.134e-03      1.391e+00   
      28             35          1.910e+00      1.377e+00      1.056e-03      3.362e-01   
      29             36          1.765e+00      1.448e-01      3.637e-03      1.080e-01   
      30             37          1.674e+00      9.061e-02      7.081e-03      3.621e-01   
      31             38          1.551e+00      1.235e-01      7.031e-03      3.336e-01   
      32             39          1.444e+00      1.064e-01      6.186e-03      2.711e-01   
      33             41          1.343e+00      1.014e-01      2.972e-03      2.419e-02   
      34             42          1.277e+00      6.647e-02      5.573e-03      7.966e-02   
      35             45          1.249e+00      2.731e-02      9.248e-04      1.189e-01   
      36             46          1.231e+00      1.813e-02      1.798e-03      1.886e-01   
      37             47          1.199e+00      3.255e-02      1.873e-03      1.593e-01   
      38             48          1.185e+00      1.327e-02      3.467e-03      2.447e-01   
      39             49          1.141e+00      4.430e-02      3.827e-03      2.197e-01   
      40             50          1.103e+00      3.821e-02      3.721e-03      2.046e-01   
      41             51          1.062e+00      4.115e-02      3.403e-03      1.218e-01   
      42             52          1.051e+00      1.085e-02      5.261e-03      6.802e-02   
      43             53          1.007e+00      4.407e-02      9.442e-04      2.468e-02   
      44             54          9.890e-01      1.781e-02      2.483e-03      3.578e-02   
      45             55          9.855e-01      3.460e-03      3.570e-03      1.176e-01   
      46             56          9.603e-01      2.521e-02      6.626e-04      6.647e-02   
      47             57          9.410e-01      1.928e-02      5.913e-04      3.171e-02   
      48             58          9.245e-01      1.655e-02      5.344e-04      3.883e-02   
      49             59          9.074e-01      1.704e-02      5.379e-04      2.966e-02   
      50             60          9.048e-01      2.670e-03      1.361e-03      1.007e-01   
      51             61          8.964e-01      8.339e-03      2.211e-04      2.897e-02   
      52             62          8.936e-01      2.852e-03      2.521e-04      2.971e-02   
      53             63          8.921e-01      1.520e-03      2.376e-04      3.274e-02   
      54             64          8.897e-01      2.333e-03      6.964e-05      1.088e-02   
      55             65          8.872e-01      2.506e-03      1.182e-04      1.539e-02   
      56             66          8.859e-01      1.324e-03      1.160e-04      1.565e-02   
      57             67          8.835e-01      2.387e-03      1.147e-04      1.251e-02   
      58             68          8.812e-01      2.287e-03      1.178e-04      1.234e-02   
      59             69          8.790e-01      2.233e-03      1.175e-04      1.143e-02   
      60             70          8.781e-01      8.965e-04      1.175e-04      1.245e-02   
      61             71          8.759e-01      2.174e-03      1.148e-04      9.121e-03   
      62             72          8.737e-01      2.190e-03      1.180e-04      8.686e-03   
      63             73          8.716e-01      2.179e-03      1.164e-04      7.894e-03   
      64             74          8.694e-01      2.188e-03      1.153e-04      7.115e-03   
      65             75          8.672e-01      2.192e-03      1.142e-04      6.456e-03   
      66             76          8.650e-01      2.196e-03      1.130e-04      5.880e-03   
      67             77          8.620e-01      3.012e-03      2.194e-04      1.136e-02   
      68             78          8.587e-01      3.242e-03      2.192e-04      8.181e-03   
      69             79          8.543e-01      4.383e-03      2.204e-04      8.733e-03   
      70             80          8.514e-01      2.969e-03      4.272e-04      1.708e-02   
      71             81          8.439e-01      7.479e-03      3.990e-04      1.500e-02   
      72             82          8.345e-01      9.393e-03      4.247e-04      9.181e-03   
      73             83          8.136e-01      2.091e-02      8.775e-04      2.542e-02   
      74             84          7.726e-01      4.104e-02      1.908e-03      2.921e-02   
      75             86          7.541e-01      1.846e-02      1.002e-03      4.264e-02   
      76             87          7.335e-01      2.059e-02      1.678e-03      1.184e-01   
      77             88          7.181e-01      1.539e-02      1.424e-03      1.216e-01   
      78             89          6.963e-01      2.185e-02      1.681e-03      7.910e-02   
      79             90          6.882e-01      8.071e-03      1.431e-03      6.912e-02   
      80             91          6.829e-01      5.276e-03      1.001e-03      5.101e-02   
      81             92          6.774e-01      5.472e-03      3.294e-04      1.258e-02   
      82             93          6.722e-01      5.285e-03      2.861e-04      2.333e-02   
      83             94          6.663e-01      5.879e-03      4.378e-04      2.045e-02   
      84             95          6.608e-01      5.530e-03      3.070e-04      1.965e-02   
      85             96          6.553e-01      5.462e-03      2.134e-04      1.909e-02   
      86             97          6.497e-01      5.616e-03      1.674e-04      1.560e-02   
      87             98          6.437e-01      6.016e-03      1.742e-04      5.388e-03   
      88             99          6.382e-01      5.476e-03      2.674e-04      1.783e-02   
      89             100         6.340e-01      4.207e-03      4.509e-04      3.436e-02   
      90             101         6.302e-01      3.726e-03      6.433e-04      4.079e-02   
      91             102         6.267e-01      3.533e-03      7.860e-04      4.418e-02   
      92             103         6.234e-01      3.354e-03      8.826e-04      4.828e-02   
      93             104         6.195e-01      3.825e-03      9.531e-04      4.672e-02   
      94             105         6.150e-01      4.524e-03      9.930e-04      3.575e-02   
      95             106         6.105e-01      4.555e-03      9.826e-04      2.359e-02   
      96             107         6.059e-01      4.542e-03      9.226e-04      3.145e-02   
      97             108         6.016e-01      4.327e-03      8.128e-04      3.450e-02   
      98             109         5.974e-01      4.186e-03      6.864e-04      3.862e-02   
      99             110         5.932e-01      4.152e-03      5.644e-04      4.107e-02   
      100            111         5.891e-01      4.148e-03      4.610e-04      4.212e-02   
      101            112         5.850e-01      4.128e-03      3.885e-04      4.136e-02   
      102            113         5.810e-01      4.004e-03      3.422e-04      3.965e-02   
      103            114         5.771e-01      3.866e-03      3.214e-04      3.601e-02   
      104            115         5.735e-01      3.638e-03      3.156e-04      3.156e-02   
      105            116         5.701e-01      3.327e-03      3.188e-04      2.730e-02   
      106            117         5.671e-01      3.002e-03      3.212e-04      2.395e-02   
      107            118         5.644e-01      2.738e-03      3.132e-04      2.161e-02   
      108            119         5.618e-01      2.571e-03      2.923e-04      1.987e-02   
      109            120         5.593e-01      2.476e-03      2.643e-04      1.840e-02   
      110            121         5.569e-01      2.420e-03      2.388e-04      1.706e-02   
      111            122         5.545e-01      2.388e-03      2.228e-04      1.578e-02   
      112            123         5.522e-01      2.373e-03      2.186e-04      1.453e-02   
      113            124         5.498e-01      2.369e-03      2.254e-04      1.338e-02   
      114            125         5.474e-01      2.374e-03      2.414e-04      1.232e-02   
      115            126         5.450e-01      2.388e-03      2.655e-04      1.151e-02   
      116            127         5.426e-01      2.410e-03      2.955e-04      1.150e-02   
      117            128         5.402e-01      2.440e-03      3.281e-04      1.252e-02   
      118            129         5.377e-01      2.470e-03      3.615e-04      1.326e-02   
      119            130         5.352e-01      2.494e-03      3.897e-04      1.365e-02   
      120            131         5.327e-01      2.498e-03      4.146e-04      1.392e-02   
      121            132         5.302e-01      2.500e-03      4.330e-04      1.388e-02   
      122            133         5.277e-01      2.496e-03      4.440e-04      1.391e-02   
      123            134         5.252e-01      2.495e-03      4.390e-04      1.487e-02   
      124            135         5.227e-01      2.493e-03      4.120e-04      1.632e-02   
      125            136         5.203e-01      2.466e-03      3.512e-04      1.880e-02   
      126            137         5.191e-01      1.162e-03      2.454e-04      1.108e-02   
      127            138         5.189e-01      1.748e-04      1.317e-04      2.852e-02   
      128            139         5.166e-01      2.299e-03      1.435e-04      1.005e-02   
      129            140         5.164e-01      2.149e-04      2.997e-04      1.954e-02   
      130            141         5.152e-01      1.199e-03      9.299e-05      3.155e-03   
      131            142         5.145e-01      7.604e-04      1.930e-04      1.008e-02   
      132            143         5.133e-01      1.127e-03      1.530e-04      2.869e-03   
      133            144         5.126e-01      7.405e-04      2.263e-04      8.280e-03   
      134            172         5.126e-01      0.000e+00      0.000e+00      8.280e-03   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 5.126e-01
         Total delta_x: 2.649e-01
         Iterations: 134
         Function evaluations: 172
         Jacobian evaluations: 134
Timer: Solution time = 6.73 min
Timer: Avg time per step = 2.99 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.991e+02  -->   5.126e-01, 
Maximum absolute Quasi-symmetry (1,0) two-term error:        3.034e-01  -->   1.318e-01 (T^3)
Minimum absolute Quasi-symmetry (1,0) two-term error:        2.375e-05  -->   2.097e-05 (T^3)
Average absolute Quasi-symmetry (1,0) two-term error:        5.504e-02  -->   1.146e-02 (T^3)
Aspect ratio:                                                6.037e+00  -->   6.000e+00 (dimensionless)
Plasma volume:                                               5.420e-01  -->   5.906e-01 (m^3)
Maximum Rotational transform:                                2.750e-02  -->   4.184e-01 (dimensionless)
Minimum Rotational transform:                                2.745e-02  -->   3.875e-01 (dimensionless)
Average Rotational transform:                                2.749e-02  -->   4.068e-01 (dimensionless)
Maximum absolute Force error:                                6.082e-01  -->   2.035e+00 (N)
Minimum absolute Force error:                                3.191e-05  -->   5.363e-06 (N)
Average absolute Force error:                                5.827e-02  -->   6.071e-02 (N)
Maximum absolute Force error:                                2.953e-07  -->   9.879e-07 (normalized)
Minimum absolute Force error:                                1.549e-11  -->   2.604e-12 (normalized)
Average absolute Force error:                                2.829e-08  -->   2.948e-08 (normalized)
Cross-section R error:                                       0.000e+00  -->   0.000e+00 (m)
Cross-section Z error:                                       0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

