/home/ye2698/DESC/desc/integrals/_interp_utils.py:19: UserWarning: 
jax-finufft is not installed.
If you want to use NUFFTs, follow the DESC installation instructions.
Otherwise you must set the parameter nufft_eps to zero
when computing effective ripple, Gamma_c, and any other
computations that involve bounce integrals.

  warnings.warn(
DESC version=0.15.0+424.gdbba9ba17.
Using JAX backend: jax version=0.6.2, jaxlib version=0.6.2, dtype=float64.
Using device: NVIDIA A100-PCIE-40GB (id=0), with 40.00 GB available memory.
Building objective: QS two-term
Precomputing transforms
Timer: Precomputing transforms = 340 ms
Building objective: aspect ratio
Precomputing transforms
Timer: Precomputing transforms = 39.3 ms
Building objective: volume
Precomputing transforms
Timer: Precomputing transforms = 39.4 ms
Building objective: rotational transform
Precomputing transforms
Timer: Precomputing transforms = 299 ms
Timer: Objective build = 808 ms
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 530 ms
Timer: Objective build = 851 ms
Timer: Objective build = 2.97 ms
Timer: Eq Update LinearConstraintProjection build = 2.24 sec
Timer: Proximal projection build = 10.2 sec
Building objective: fixed cross-section R
Building objective: fixed cross-section Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 285 ms
Timer: LinearConstraintProjection build = 836 ms
Number of parameters: 45
Number of objectives: 478
Timer: Initializing the optimization = 11.4 sec

Starting optimization
Using method: proximal-lsq-exact
Solver options:
------------------------------------------------------------
Maximum Function Evaluations       : 1251
Maximum Allowed Total Î”x Norm      : inf
Scaled Termination                 : True
Trust Region Method                : qr
Initial Trust Radius               : 1.318e+01
Maximum Trust Radius               : inf
Minimum Trust Radius               : 2.220e-16
Trust Radius Increase Ratio        : 2.000e+00
Trust Radius Decrease Ratio        : 2.500e-01
Trust Radius Increase Threshold    : 7.500e-01
Trust Radius Decrease Threshold    : 2.500e-01
------------------------------------------------------------ 

   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          7.752e+02                                    1.010e+01   
       1              3          7.415e+02      3.369e+01      9.558e-03      2.751e+01   
       2              4          6.925e+02      4.904e+01      1.368e-02      1.354e+01   
       3              5          5.576e+02      1.348e+02      2.082e-02      1.142e+01   
       4              6          4.679e+02      8.970e+01      3.160e-02      1.544e+01   
       5              7          3.739e+02      9.399e+01      2.639e-02      1.322e+01   
       6              8          2.128e+02      1.611e+02      7.840e-03      1.022e+01   
       7              9          1.017e+02      1.111e+02      5.888e-02      4.524e+00   
       8             10          8.887e+01      1.282e+01      8.370e-02      4.845e+00   
       9             11          4.285e+01      4.602e+01      2.792e-02      2.853e+00   
      10             12          3.606e+01      6.787e+00      5.692e-02      2.021e+00   
      11             13          3.414e+01      1.918e+00      2.149e-02      1.944e+00   
      12             14          2.037e+01      1.377e+01      1.344e-02      6.788e-01   
      13             15          1.496e+01      5.407e+00      2.246e-02      4.290e-01   
      14             16          1.248e+01      2.483e+00      2.198e-02      6.117e-01   
      15             18          1.028e+01      2.194e+00      2.844e-02      3.492e-01   
      16             19          9.433e+00      8.505e-01      5.078e-02      5.493e-01   
      17             21          8.623e+00      8.104e-01      1.121e-02      7.670e-01   
      18             22          7.128e+00      1.494e+00      1.112e-02      2.837e-01   
      19             23          7.096e+00      3.218e-02      2.355e-02      8.820e-01   
      20             24          6.353e+00      7.430e-01      6.552e-03      4.208e-01   
      21             25          5.871e+00      4.828e-01      1.317e-02      2.689e-01   
      22             27          5.764e+00      1.069e-01      4.859e-03      2.440e-01   
      23             29          5.683e+00      8.021e-02      5.742e-04      1.775e-01   
      24             30          5.610e+00      7.331e-02      8.978e-04      1.087e-01   
      25             31          5.558e+00      5.179e-02      1.125e-03      1.003e-01   
      26             32          5.501e+00      5.752e-02      1.487e-03      1.145e-01   
      27             34          5.448e+00      5.295e-02      9.640e-04      1.234e-01   
      28             35          5.358e+00      9.011e-02      2.175e-03      1.212e-01   
      29             36          5.234e+00      1.240e-01      5.075e-03      1.944e-01   
      30             37          5.083e+00      1.511e-01      5.985e-03      1.486e-01   
      31             38          4.833e+00      2.501e-01      6.363e-03      1.516e-01   
      32             39          4.508e+00      3.245e-01      1.293e-02      2.149e-01   
      33             40          3.994e+00      5.141e-01      2.645e-02      5.006e-01   
      34             41          2.974e+00      1.020e+00      4.557e-02      5.999e-01   
      35             43          2.429e+00      5.456e-01      2.155e-02      3.365e-01   
      36             45          2.150e+00      2.783e-01      1.187e-02      1.512e-01   
      37             46          1.904e+00      2.463e-01      1.819e-02      3.082e-01   
      38             47          1.441e+00      4.627e-01      1.532e-02      2.755e-01   
      39             49          1.400e+00      4.139e-02      9.359e-03      3.798e-01   
      40             50          1.272e+00      1.275e-01      1.333e-03      1.309e-01   
      41             51          1.188e+00      8.419e-02      3.642e-03      1.124e-01   
      42             52          1.082e+00      1.058e-01      7.257e-03      1.370e-01   
      43             53          1.056e+00      2.634e-02      1.177e-02      2.349e-01   
      44             55          9.959e-01      6.021e-02      3.659e-04      1.828e-01   
      45             56          9.480e-01      4.784e-02      6.376e-04      1.168e-01   
      46             57          9.087e-01      3.933e-02      2.225e-04      9.019e-02   
      47             58          8.781e-01      3.063e-02      2.717e-04      8.140e-02   
      48             59          8.503e-01      2.773e-02      4.568e-04      7.206e-02   
      49             60          8.254e-01      2.494e-02      6.334e-04      6.695e-02   
      50             61          8.017e-01      2.371e-02      7.267e-04      6.217e-02   
      51             62          7.787e-01      2.300e-02      7.796e-04      5.889e-02   
      52             63          7.564e-01      2.229e-02      8.251e-04      5.851e-02   
      53             64          7.348e-01      2.159e-02      8.703e-04      5.746e-02   
      54             65          7.135e-01      2.134e-02      9.068e-04      5.405e-02   
      55             66          7.053e-01      8.160e-03      2.035e-03      1.108e-01   
      56             67          6.813e-01      2.403e-02      1.881e-04      7.921e-02   
      57             68          6.725e-01      8.827e-03      3.122e-04      5.601e-02   
      58             69          6.620e-01      1.048e-02      2.853e-04      5.511e-02   
      59             70          6.458e-01      1.621e-02      3.331e-04      3.572e-02   
      60             71          6.157e-01      3.007e-02      1.029e-03      6.588e-02   
      61             72          5.990e-01      1.669e-02      2.738e-03      1.475e-01   
      62             73          5.468e-01      5.215e-02      2.864e-03      9.145e-02   
      63             75          5.237e-01      2.314e-02      1.409e-03      2.549e-02   
      64             76          5.017e-01      2.202e-02      2.689e-03      6.054e-02   
      65             77          4.816e-01      2.010e-02      2.398e-03      5.139e-02   
      66             78          4.637e-01      1.793e-02      2.295e-03      5.278e-02   
      67             79          4.320e-01      3.169e-02      3.292e-03      8.369e-02   
      68             80          3.664e-01      6.556e-02      3.531e-03      1.056e-01   
      69             81          3.470e-01      1.942e-02      4.718e-03      1.902e-01   
      70             82          3.390e-01      7.946e-03      1.111e-03      2.632e-01   
      71             83          2.872e-01      5.186e-02      9.379e-04      8.304e-02   
      72             84          2.800e-01      7.138e-03      1.140e-03      8.957e-02   
      73             85          2.696e-01      1.046e-02      8.504e-04      2.613e-02   
      74             86          2.644e-01      5.174e-03      4.635e-04      2.526e-02   
      75             87          2.595e-01      4.887e-03      1.984e-04      2.539e-02   
      76             88          2.547e-01      4.864e-03      1.465e-04      2.241e-02   
      77             89          2.500e-01      4.695e-03      1.863e-04      2.039e-02   
      78             90          2.453e-01      4.673e-03      2.353e-04      1.870e-02   
      79             92          2.432e-01      2.112e-03      9.640e-05      7.194e-03   
      80             93          2.399e-01      3.319e-03      1.072e-04      1.331e-02   
      81             95          2.380e-01      1.841e-03      8.005e-05      5.481e-03   
      82             96          2.351e-01      2.926e-03      1.639e-04      1.243e-02   
      83             98          2.333e-01      1.784e-03      1.110e-04      5.258e-03   
      84             99          2.305e-01      2.843e-03      1.893e-04      1.187e-02   
      85             101         2.287e-01      1.729e-03      1.196e-04      5.132e-03   
      86             102         2.259e-01      2.791e-03      2.029e-04      1.119e-02   
      87             104         2.243e-01      1.685e-03      1.242e-04      5.303e-03   
      88             105         2.215e-01      2.760e-03      2.123e-04      1.058e-02   
      89             107         2.198e-01      1.655e-03      1.274e-04      5.514e-03   
      90             108         2.171e-01      2.744e-03      2.196e-04      1.005e-02   
      91             110         2.155e-01      1.636e-03      1.298e-04      5.749e-03   
      92             111         2.127e-01      2.742e-03      2.259e-04      9.582e-03   
      93             112         2.089e-01      3.815e-03      4.527e-04      2.099e-02   
      94             113         2.046e-01      4.303e-03      4.375e-04      2.114e-02   
      95             114         1.999e-01      4.680e-03      3.928e-04      2.206e-02   
      96             115         1.951e-01      4.863e-03      3.770e-04      2.164e-02   
      97             116         1.901e-01      4.926e-03      3.623e-04      2.122e-02   
      98             118         1.866e-01      3.509e-03      1.676e-04      8.417e-03   
      99             119         1.823e-01      4.298e-03      3.251e-04      2.402e-02   
      100            120         1.773e-01      5.071e-03      3.051e-04      2.193e-02   
      101            121         1.750e-01      2.284e-03      6.028e-04      7.215e-02   
      102            122         1.662e-01      8.796e-03      1.036e-04      1.766e-02   
      103            123         1.630e-01      3.194e-03      3.006e-04      6.432e-02   
      104            124         1.561e-01      6.874e-03      5.058e-04      3.155e-02   
      105            125         1.504e-01      5.709e-03      1.595e-03      8.259e-02   
      106            126         1.416e-01      8.760e-03      2.120e-03      4.878e-02   
      107            127         1.414e-01      2.828e-04      1.784e-03      4.978e-02   
      108            128         1.348e-01      6.588e-03      3.111e-04      7.552e-03   
      109            129         1.326e-01      2.178e-03      6.622e-04      1.437e-02   
      110            130         1.306e-01      2.015e-03      5.129e-04      1.543e-02   
      111            131         1.286e-01      1.936e-03      4.329e-04      1.809e-02   
      112            132         1.267e-01      1.891e-03      3.766e-04      1.902e-02   
      113            133         1.249e-01      1.841e-03      3.392e-04      1.976e-02   
      114            134         1.231e-01      1.808e-03      3.128e-04      2.000e-02   
      115            135         1.213e-01      1.781e-03      2.929e-04      2.018e-02   
      116            136         1.195e-01      1.767e-03      2.781e-04      2.024e-02   
      117            137         1.178e-01      1.762e-03      2.683e-04      2.022e-02   
      118            138         1.160e-01      1.775e-03      2.631e-04      2.000e-02   
      119            139         1.143e-01      1.745e-03      2.576e-04      2.153e-02   
      120            141         1.132e-01      1.015e-03      8.551e-05      6.148e-03   
      121            142         1.125e-01      7.309e-04      1.208e-04      2.191e-02   
      122            143         1.116e-01      8.805e-04      1.237e-04      1.077e-02   
      123            144         1.106e-01      9.977e-04      1.225e-04      1.530e-02   
      124            145         1.095e-01      1.168e-03      2.069e-04      2.811e-02   
      125            147         1.083e-01      1.128e-03      7.779e-05      6.817e-03   
      126            148         1.076e-01      7.470e-04      1.060e-04      2.055e-02   
      127            149         1.067e-01      9.231e-04      1.047e-04      1.054e-02   
      128            175         1.067e-01      0.000e+00      0.000e+00      1.054e-02   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.067e-01
         Total delta_x: 2.729e-01
         Iterations: 128
         Function evaluations: 175
         Jacobian evaluations: 128
Timer: Solution time = 8.79 min
Timer: Avg time per step = 4.09 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      7.751e+02  -->   1.067e-01, 
Maximum absolute Quasi-symmetry (1,0) two-term error:        3.034e-01  -->   7.503e-02 (T^3)
Minimum absolute Quasi-symmetry (1,0) two-term error:        2.375e-05  -->   1.225e-05 (T^3)
Average absolute Quasi-symmetry (1,0) two-term error:        5.504e-02  -->   8.361e-03 (T^3)
Aspect ratio:                                                6.037e+00  -->   5.999e+00 (dimensionless)
Plasma volume:                                               5.420e-01  -->   5.892e-01 (m^3)
Maximum Rotational transform:                                2.750e-02  -->   4.204e-01 (dimensionless)
Minimum Rotational transform:                                2.745e-02  -->   4.190e-01 (dimensionless)
Average Rotational transform:                                2.749e-02  -->   4.201e-01 (dimensionless)
Maximum absolute Force error:                                6.082e-01  -->   1.188e+00 (N)
Minimum absolute Force error:                                3.191e-05  -->   8.665e-06 (N)
Average absolute Force error:                                5.827e-02  -->   2.896e-02 (N)
Maximum absolute Force error:                                2.953e-07  -->   5.767e-07 (normalized)
Minimum absolute Force error:                                1.549e-11  -->   4.207e-12 (normalized)
Average absolute Force error:                                2.829e-08  -->   1.406e-08 (normalized)
Cross-section R error:                                       0.000e+00  -->   0.000e+00 (m)
Cross-section Z error:                                       0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

