/home/ye2698/DESC/desc/integrals/_interp_utils.py:19: UserWarning: 
jax-finufft is not installed.
If you want to use NUFFTs, follow the DESC installation instructions.
Otherwise you must set the parameter nufft_eps to zero
when computing effective ripple, Gamma_c, and any other
computations that involve bounce integrals.

  warnings.warn(
DESC version=0.15.0+424.gdbba9ba17.
Using JAX backend: jax version=0.6.2, jaxlib version=0.6.2, dtype=float64.
Using device: NVIDIA A100-PCIE-40GB (id=0), with 40.00 GB available memory.
Building objective: QS two-term
Precomputing transforms
Timer: Precomputing transforms = 343 ms
Building objective: aspect ratio
Precomputing transforms
Timer: Precomputing transforms = 41.1 ms
Building objective: volume
Precomputing transforms
Timer: Precomputing transforms = 41.1 ms
Building objective: rotational transform
Precomputing transforms
Timer: Precomputing transforms = 302 ms
Timer: Objective build = 818 ms
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 532 ms
Timer: Objective build = 856 ms
Timer: Objective build = 3.04 ms
Timer: Eq Update LinearConstraintProjection build = 2.26 sec
Timer: Proximal projection build = 10.3 sec
Building objective: fixed cross-section R
Building objective: fixed cross-section Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 287 ms
Timer: LinearConstraintProjection build = 836 ms
Number of parameters: 45
Number of objectives: 478
Timer: Initializing the optimization = 11.5 sec

Starting optimization
Using method: proximal-lsq-exact
Solver options:
------------------------------------------------------------
Maximum Function Evaluations       : 1251
Maximum Allowed Total Î”x Norm      : inf
Scaled Termination                 : True
Trust Region Method                : qr
Initial Trust Radius               : 3.497e+01
Maximum Trust Radius               : inf
Minimum Trust Radius               : 2.220e-16
Trust Radius Increase Ratio        : 2.000e+00
Trust Radius Decrease Ratio        : 2.500e-01
Trust Radius Increase Threshold    : 7.500e-01
Trust Radius Decrease Threshold    : 2.500e-01
------------------------------------------------------------ 

   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          3.735e+01                                    2.014e+00   
       1              5          3.539e+01      1.964e+00      1.221e-03      6.604e-01   
       2              6          3.487e+01      5.152e-01      2.493e-03      3.587e-01   
       3              7          3.443e+01      4.401e-01      2.237e-03      3.329e-01   
       4              8          3.376e+01      6.710e-01      4.371e-03      7.579e-01   
       5              9          3.322e+01      5.431e-01      7.355e-03      1.621e+00   
       6             10          3.194e+01      1.282e+00      1.580e-03      3.624e-01   
       7             11          3.178e+01      1.517e-01      2.129e-03      3.623e-01   
       8             12          3.158e+01      1.999e-01      7.057e-04      1.387e-01   
       9             13          3.144e+01      1.452e-01      1.385e-03      2.488e-01   
      10             14          3.117e+01      2.678e-01      1.490e-03      2.724e-01   
      11             17          3.110e+01      6.868e-02      1.847e-04      1.705e-01   
      12             18          3.105e+01      5.425e-02      4.017e-04      1.653e-01   
      13             19          3.098e+01      6.777e-02      3.944e-04      1.449e-01   
      14             20          3.092e+01      6.277e-02      3.904e-04      1.381e-01   
      15             21          3.083e+01      8.361e-02      3.784e-04      1.484e-01   
      16             22          3.070e+01      1.339e-01      7.530e-04      2.235e-01   
      17             23          3.051e+01      1.879e-01      7.122e-04      2.461e-01   
      18             24          3.025e+01      2.609e-01      1.570e-03      4.639e-01   
      19             25          2.995e+01      3.044e-01      3.103e-03      8.134e-01   
      20             26          2.917e+01      7.810e-01      3.011e-03      7.013e-01   
      21             27          2.785e+01      1.320e+00      5.287e-03      4.408e-01   
      22             29          2.677e+01      1.080e+00      1.355e-03      1.107e-01   
      23             30          2.506e+01      1.704e+00      2.939e-03      3.339e-01   
      24             32          2.439e+01      6.729e-01      1.669e-03      7.219e-01   
      25             33          2.319e+01      1.197e+00      4.422e-03      3.438e-01   
      26             34          2.167e+01      1.525e+00      9.924e-03      3.166e-01   
      27             35          1.955e+01      2.116e+00      6.917e-03      2.948e-01   
      28             36          1.746e+01      2.091e+00      2.930e-02      1.425e+00   
      29             37          1.386e+01      3.596e+00      1.294e-02      1.293e+00   
      30             38          1.040e+01      3.459e+00      1.378e-02      6.440e-01   
      31             40          9.256e+00      1.149e+00      5.119e-03      1.184e+00   
      32             41          8.728e+00      5.282e-01      5.120e-03      7.606e-01   
      33             42          7.157e+00      1.570e+00      2.812e-03      6.436e-01   
      34             44          6.698e+00      4.596e-01      5.668e-03      3.718e-01   
      35             46          6.443e+00      2.547e-01      3.176e-03      1.269e-01   
      36             48          6.360e+00      8.281e-02      1.472e-03      1.003e-01   
      37             49          6.255e+00      1.055e-01      3.176e-03      2.513e-01   
      38             50          6.064e+00      1.907e-01      6.419e-03      4.478e-01   
      39             51          5.701e+00      3.632e-01      7.332e-03      3.612e-01   
      40             52          5.595e+00      1.057e-01      1.596e-02      7.810e-01   
      41             53          5.059e+00      5.362e-01      4.556e-03      4.260e-01   
      42             54          4.963e+00      9.593e-02      9.976e-03      6.545e-01   
      43             55          4.886e+00      7.683e-02      1.002e-02      9.419e-01   
      44             56          4.313e+00      5.730e-01      1.965e-03      8.910e-02   
      45             58          4.269e+00      4.453e-02      7.251e-04      8.547e-02   
      46             59          4.200e+00      6.881e-02      1.667e-03      1.585e-01   
      47             60          4.160e+00      3.960e-02      3.625e-03      4.922e-01   
      48             61          3.973e+00      1.870e-01      3.536e-03      4.218e-01   
      49             62          3.640e+00      3.328e-01      7.486e-03      2.674e-01   
      50             64          3.470e+00      1.702e-01      3.402e-03      1.213e-01   
      51             65          3.319e+00      1.507e-01      7.759e-03      9.334e-02   
      52             66          3.169e+00      1.502e-01      1.556e-02      7.185e-01   
      53             68          2.856e+00      3.132e-01      4.362e-03      2.259e-01   
      54             70          2.809e+00      4.687e-02      2.001e-03      1.383e-01   
      55             71          2.804e+00      5.538e-03      4.076e-03      3.471e-01   
      56             72          2.731e+00      7.279e-02      9.969e-04      1.573e-02   
      57             73          2.723e+00      7.863e-03      1.819e-03      2.098e-01   
      58             74          2.696e+00      2.741e-02      4.840e-04      1.414e-02   
      59             75          2.683e+00      1.222e-02      8.456e-04      1.178e-01   
      60             76          2.662e+00      2.099e-02      8.871e-04      9.993e-02   
      61             77          2.649e+00      1.368e-02      1.745e-03      2.293e-01   
      62             78          2.612e+00      3.681e-02      1.783e-03      2.103e-01   
      63             79          2.581e+00      3.075e-02      1.819e-03      2.147e-01   
      64             80          2.547e+00      3.414e-02      1.875e-03      1.941e-01   
      65             81          2.516e+00      3.115e-02      1.899e-03      1.682e-01   
      66             82          2.484e+00      3.225e-02      1.883e-03      1.438e-01   
      67             83          2.450e+00      3.314e-02      3.620e-03      2.734e-01   
      68             84          2.372e+00      7.888e-02      3.454e-03      1.897e-01   
      69             85          2.295e+00      7.659e-02      6.390e-03      2.184e-01   
      70             86          2.162e+00      1.325e-01      4.853e-03      1.119e-01   
      71             88          2.130e+00      3.259e-02      3.087e-03      2.736e-01   
      72             89          2.062e+00      6.805e-02      3.651e-03      2.536e-01   
      73             90          1.994e+00      6.755e-02      3.771e-03      2.480e-01   
      74             91          1.917e+00      7.731e-02      3.849e-03      2.085e-01   
      75             92          1.813e+00      1.041e-01      7.923e-03      1.955e-01   
      76             93          1.679e+00      1.336e-01      7.932e-03      1.900e-01   
      77             94          1.580e+00      9.876e-02      8.115e-03      3.573e-01   
      78             95          1.480e+00      1.010e-01      7.570e-03      3.290e-01   
      79             96          1.383e+00      9.691e-02      6.237e-03      4.158e-01   
      80             97          1.221e+00      1.620e-01      5.789e-03      5.268e-02   
      81             99          1.168e+00      5.285e-02      1.935e-03      4.779e-02   
      82             101         1.135e+00      3.233e-02      8.560e-04      3.597e-02   
      83             102         1.097e+00      3.799e-02      2.127e-03      6.578e-02   
      84             103         1.038e+00      5.931e-02      2.369e-03      8.815e-02   
      85             104         9.843e-01      5.380e-02      5.359e-03      1.133e-01   
      86             105         8.876e-01      9.669e-02      5.861e-03      1.060e-01   
      87             107         8.334e-01      5.418e-02      3.149e-03      5.377e-02   
      88             109         8.155e-01      1.796e-02      1.682e-03      2.426e-02   
      89             110         7.910e-01      2.454e-02      3.185e-03      4.748e-02   
      90             111         7.691e-01      2.189e-02      2.806e-03      9.270e-02   
      91             112         7.440e-01      2.505e-02      2.369e-03      7.507e-02   
      92             114         7.317e-01      1.230e-02      4.203e-04      2.034e-02   
      93             115         7.207e-01      1.098e-02      1.042e-03      1.726e-02   
      94             116         7.103e-01      1.043e-02      9.726e-04      1.985e-02   
      95             117         7.008e-01      9.457e-03      9.211e-04      2.234e-02   
      96             118         6.922e-01      8.675e-03      8.678e-04      2.415e-02   
      97             119         6.862e-01      5.980e-03      8.119e-04      3.579e-02   
      98             120         6.802e-01      6.021e-03      6.900e-04      2.556e-02   
      99             121         6.741e-01      6.047e-03      6.241e-04      2.350e-02   
      100            122         6.643e-01      9.857e-03      6.697e-04      4.195e-02   
      101            123         6.526e-01      1.165e-02      8.195e-04      2.726e-02   
      102            124         6.420e-01      1.064e-02      9.605e-04      1.508e-02   
      103            125         6.363e-01      5.693e-03      1.079e-03      2.158e-02   
      104            126         6.317e-01      4.613e-03      1.129e-03      2.569e-02   
      105            127         6.275e-01      4.183e-03      2.421e-04      1.523e-02   
      106            128         6.238e-01      3.719e-03      2.914e-04      7.705e-03   
      107            129         6.179e-01      5.861e-03      5.987e-04      1.293e-02   
      108            130         6.119e-01      5.986e-03      5.987e-04      1.124e-02   
      109            131         6.060e-01      5.954e-03      6.083e-04      1.028e-02   
      110            132         6.000e-01      5.944e-03      6.147e-04      8.702e-03   
      111            133         5.941e-01      5.939e-03      6.210e-04      6.974e-03   
      112            134         5.881e-01      5.960e-03      6.272e-04      1.014e-02   
      113            135         5.821e-01      6.009e-03      6.333e-04      1.327e-02   
      114            136         5.760e-01      6.080e-03      6.397e-04      1.615e-02   
      115            137         5.699e-01      6.162e-03      6.464e-04      1.875e-02   
      116            138         5.636e-01      6.242e-03      6.534e-04      2.103e-02   
      117            139         5.573e-01      6.310e-03      6.609e-04      2.298e-02   
      118            140         5.510e-01      6.355e-03      6.689e-04      2.462e-02   
      119            141         5.446e-01      6.374e-03      6.770e-04      2.594e-02   
      120            142         5.311e-01      1.349e-02      1.353e-03      5.232e-02   
      121            143         5.124e-01      1.873e-02      2.698e-03      5.830e-02   
      122            144         4.960e-01      1.640e-02      2.721e-03      7.626e-02   
      123            145         4.776e-01      1.835e-02      2.620e-03      2.122e-02   
      124            146         4.641e-01      1.351e-02      2.260e-03      3.610e-02   
      125            148         4.579e-01      6.189e-03      4.101e-04      9.389e-03   
      126            150         4.546e-01      3.286e-03      2.226e-04      5.685e-03   
      127            151         4.501e-01      4.507e-03      4.288e-04      2.328e-02   
      128            152         4.453e-01      4.787e-03      3.832e-04      2.519e-02   
      129            153         4.406e-01      4.733e-03      3.504e-04      2.983e-02   
      130            154         4.357e-01      4.863e-03      3.147e-04      3.245e-02   
      131            155         4.308e-01      4.969e-03      2.811e-04      3.491e-02   
      132            156         4.257e-01      5.111e-03      2.495e-04      3.685e-02   
      133            157         4.204e-01      5.257e-03      2.202e-04      3.840e-02   
      134            158         4.150e-01      5.393e-03      1.935e-04      3.958e-02   
      135            159         4.095e-01      5.505e-03      1.691e-04      4.034e-02   
      136            160         4.039e-01      5.564e-03      1.471e-04      4.105e-02   
      137            161         3.983e-01      5.634e-03      1.280e-04      4.033e-02   
      138            162         3.927e-01      5.617e-03      1.115e-04      3.911e-02   
      139            163         3.871e-01      5.552e-03      9.734e-05      3.776e-02   
      140            164         3.816e-01      5.516e-03      8.544e-05      3.520e-02   
      141            165         3.762e-01      5.460e-03      7.621e-05      3.195e-02   
      142            166         3.708e-01      5.418e-03      6.976e-05      2.809e-02   
      143            167         3.654e-01      5.391e-03      6.644e-05      2.382e-02   
      144            168         3.600e-01      5.377e-03      6.645e-05      1.958e-02   
      145            169         3.586e-01      1.419e-03      1.306e-04      1.022e-01   
      146            170         3.503e-01      8.258e-03      2.718e-05      2.507e-02   
      147            171         3.440e-01      6.290e-03      1.381e-04      1.243e-02   
      148            172         3.329e-01      1.114e-02      1.800e-04      8.122e-03   
      149            173         3.149e-01      1.793e-02      3.927e-04      2.135e-02   
      150            174         3.052e-01      9.793e-03      1.294e-03      1.048e-01   
      151            176         2.939e-01      1.126e-02      8.658e-04      8.811e-02   
      152            177         2.857e-01      8.147e-03      9.048e-04      5.034e-02   
      153            178         2.827e-01      3.081e-03      9.073e-04      4.629e-02   
      154            179         2.806e-01      2.025e-03      9.879e-04      5.319e-02   
      155            180         2.793e-01      1.353e-03      1.063e-03      4.733e-02   
      156            181         2.772e-01      2.103e-03      3.434e-04      2.099e-02   
      157            182         2.763e-01      8.845e-04      3.048e-04      2.076e-02   
      158            183         2.752e-01      1.050e-03      2.985e-04      1.728e-02   
      159            184         2.742e-01      1.041e-03      2.918e-04      1.556e-02   
      160            185         2.731e-01      1.058e-03      2.865e-04      1.400e-02   
      161            186         2.721e-01      1.068e-03      2.807e-04      1.265e-02   
      162            187         2.714e-01      6.689e-04      2.742e-04      1.212e-02   
      163            188         2.702e-01      1.197e-03      2.740e-04      7.805e-03   
      164            189         2.687e-01      1.528e-03      5.089e-04      1.800e-02   
      165            190         2.668e-01      1.864e-03      4.956e-04      1.294e-02   
      166            191         2.651e-01      1.763e-03      4.703e-04      1.203e-02   
      167            192         2.633e-01      1.745e-03      4.479e-04      1.102e-02   
      168            193         2.616e-01      1.729e-03      4.261e-04      1.053e-02   
      169            194         2.599e-01      1.726e-03      4.058e-04      1.064e-02   
      170            195         2.581e-01      1.752e-03      3.879e-04      1.102e-02   
      171            196         2.563e-01      1.798e-03      3.721e-04      1.161e-02   
      172            197         2.544e-01      1.863e-03      3.583e-04      1.226e-02   
      173            198         2.525e-01      1.942e-03      3.457e-04      1.285e-02   
      174            199         2.504e-01      2.122e-03      6.227e-04      2.772e-02   
      175            200         2.462e-01      4.151e-03      5.795e-04      2.022e-02   
      176            201         2.412e-01      5.018e-03      5.016e-04      3.472e-02   
      177            203         2.362e-01      4.989e-03      1.984e-04      1.700e-02   
      178            204         2.332e-01      3.062e-03      2.817e-04      5.962e-02   
      179            205         2.291e-01      4.091e-03      1.334e-04      7.359e-02   
      180            206         2.279e-01      1.161e-03      2.008e-04      9.791e-02   
      181            207         2.182e-01      9.717e-03      1.024e-04      1.166e-02   
      182            208         2.181e-01      1.165e-04      2.353e-04      5.878e-02   
      183            209         2.145e-01      3.548e-03      1.026e-04      1.208e-02   
      184            210         2.145e-01      6.153e-05      1.836e-04      4.051e-02   
      185            211         2.129e-01      1.568e-03      6.669e-05      4.721e-03   
      186            212         2.124e-01      5.314e-04      1.031e-04      1.872e-02   
      187            213         2.116e-01      8.033e-04      1.226e-04      1.631e-02   
      188            214         2.113e-01      2.151e-04      2.566e-04      3.592e-02   
      189            215         2.101e-01      1.227e-03      7.803e-05      5.470e-03   
      190            216         2.096e-01      4.890e-04      1.325e-04      1.695e-02   
      191            217         2.089e-01      7.106e-04      1.473e-04      1.493e-02   
      192            218         2.087e-01      2.076e-04      2.997e-04      3.292e-02   
      193            219         2.077e-01      1.042e-03      8.447e-05      5.568e-03   
      194            220         2.072e-01      5.001e-04      1.495e-04      1.500e-02   
      195            221         2.065e-01      6.685e-04      1.613e-04      1.313e-02   
      196            222         2.055e-01      1.004e-03      3.224e-04      2.322e-02   
      197            223         2.049e-01      5.728e-04      3.362e-04      2.868e-02   
      198            224         2.034e-01      1.568e-03      3.301e-04      1.844e-02   
      199            225         2.023e-01      1.106e-03      6.432e-04      4.173e-02   
      200            226         2.002e-01      2.063e-03      6.364e-04      3.958e-02   
      201            227         1.981e-01      2.069e-03      6.142e-04      3.878e-02   
      202            228         1.961e-01      2.068e-03      5.959e-04      3.859e-02   
      203            229         1.940e-01      2.090e-03      5.764e-04      3.852e-02   
      204            230         1.918e-01      2.136e-03      5.533e-04      3.821e-02   
      205            231         1.896e-01      2.194e-03      5.261e-04      3.747e-02   
      206            232         1.886e-01      1.071e-03      8.952e-04      8.601e-02   
      207            233         1.839e-01      4.703e-03      2.185e-04      1.513e-02   
      208            234         1.822e-01      1.622e-03      3.861e-04      3.352e-02   
      209            235         1.817e-01      5.343e-04      6.475e-04      7.605e-02   
      210            236         1.778e-01      3.872e-03      1.668e-04      1.058e-02   
      211            237         1.767e-01      1.092e-03      2.582e-04      1.714e-02   
      212            238         1.755e-01      1.210e-03      2.706e-04      1.155e-02   
      213            239         1.748e-01      7.357e-04      2.773e-04      1.195e-02   
      214            240         1.741e-01      7.272e-04      2.895e-04      8.656e-03   
      215            241         1.734e-01      6.935e-04      3.012e-04      6.886e-03   
      216            242         1.727e-01      6.786e-04      3.109e-04      6.123e-03   
      217            243         1.720e-01      6.812e-04      3.193e-04      5.468e-03   
      218            245         1.717e-01      3.446e-04      8.395e-05      4.218e-03   
      219            246         1.710e-01      6.336e-04      1.647e-04      3.400e-03   
      220            247         1.704e-01      6.121e-04      3.317e-04      4.759e-03   
      221            249         1.701e-01      3.298e-04      8.400e-05      5.013e-03   
      222            250         1.695e-01      6.234e-04      1.699e-04      3.499e-03   
      223            252         1.691e-01      3.256e-04      8.771e-05      2.147e-03   
      224            253         1.685e-01      6.245e-04      1.697e-04      3.401e-03   
      225            255         1.682e-01      3.264e-04      8.724e-05      2.022e-03   
      226            256         1.676e-01      6.278e-04      1.696e-04      3.426e-03   
      227            258         1.672e-01      3.273e-04      8.687e-05      1.911e-03   
      228            259         1.671e-01      1.361e-04      1.694e-04      3.855e-03   
      229            285         1.671e-01      0.000e+00      0.000e+00      3.855e-03   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.671e-01
         Total delta_x: 2.604e-01
         Iterations: 229
         Function evaluations: 285
         Jacobian evaluations: 229
Timer: Solution time = 10.5 min
Timer: Avg time per step = 2.74 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      3.730e+01  -->   1.671e-01, 
Maximum absolute Quasi-symmetry (1,0) two-term error:        3.034e-01  -->   1.109e-01 (T^3)
Minimum absolute Quasi-symmetry (1,0) two-term error:        2.375e-05  -->   1.060e-05 (T^3)
Average absolute Quasi-symmetry (1,0) two-term error:        5.504e-02  -->   1.110e-02 (T^3)
Aspect ratio:                                                6.037e+00  -->   6.000e+00 (dimensionless)
Plasma volume:                                               5.420e-01  -->   5.952e-01 (m^3)
Maximum Rotational transform:                                2.750e-02  -->   4.243e-01 (dimensionless)
Minimum Rotational transform:                                2.745e-02  -->   4.127e-01 (dimensionless)
Average Rotational transform:                                2.749e-02  -->   4.205e-01 (dimensionless)
Maximum absolute Force error:                                6.082e-01  -->   1.169e+00 (N)
Minimum absolute Force error:                                3.191e-05  -->   1.104e-05 (N)
Average absolute Force error:                                5.827e-02  -->   2.123e-02 (N)
Maximum absolute Force error:                                2.953e-07  -->   5.676e-07 (normalized)
Minimum absolute Force error:                                1.549e-11  -->   5.360e-12 (normalized)
Average absolute Force error:                                2.829e-08  -->   1.031e-08 (normalized)
Cross-section R error:                                       0.000e+00  -->   0.000e+00 (m)
Cross-section Z error:                                       0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

