/home/ye2698/DESC/desc/integrals/_interp_utils.py:19: UserWarning: 
jax-finufft is not installed.
If you want to use NUFFTs, follow the DESC installation instructions.
Otherwise you must set the parameter nufft_eps to zero
when computing effective ripple, Gamma_c, and any other
computations that involve bounce integrals.

  warnings.warn(
DESC version=0.15.0+424.gdbba9ba17.
Using JAX backend: jax version=0.6.2, jaxlib version=0.6.2, dtype=float64.
Using device: NVIDIA A100-PCIE-40GB (id=0), with 40.00 GB available memory.
Building objective: QS two-term
Precomputing transforms
Timer: Precomputing transforms = 341 ms
Building objective: aspect ratio
Precomputing transforms
Timer: Precomputing transforms = 39.7 ms
Building objective: volume
Precomputing transforms
Timer: Precomputing transforms = 39.7 ms
Building objective: rotational transform
Precomputing transforms
Timer: Precomputing transforms = 299 ms
Timer: Objective build = 809 ms
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 526 ms
Timer: Objective build = 848 ms
Timer: Objective build = 3.15 ms
Timer: Eq Update LinearConstraintProjection build = 2.24 sec
Timer: Proximal projection build = 10.2 sec
Building objective: fixed cross-section R
Building objective: fixed cross-section Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 284 ms
Timer: LinearConstraintProjection build = 836 ms
Number of parameters: 45
Number of objectives: 478
Timer: Initializing the optimization = 11.4 sec

Starting optimization
Using method: proximal-lsq-exact
Solver options:
------------------------------------------------------------
Maximum Function Evaluations       : 1251
Maximum Allowed Total Î”x Norm      : inf
Scaled Termination                 : True
Trust Region Method                : qr
Initial Trust Radius               : 3.535e+01
Maximum Trust Radius               : inf
Minimum Trust Radius               : 2.220e-16
Trust Radius Increase Ratio        : 2.000e+00
Trust Radius Decrease Ratio        : 2.500e-01
Trust Radius Increase Threshold    : 7.500e-01
Trust Radius Decrease Threshold    : 2.500e-01
------------------------------------------------------------ 

   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          7.789e+02                                    7.871e+00   
       1              4          7.558e+02      2.310e+01      1.861e-03      8.118e+00   
       2              5          7.364e+02      1.939e+01      1.564e-03      5.672e+00   
       3              6          7.049e+02      3.152e+01      2.156e-03      5.221e+00   
       4              8          6.912e+02      1.366e+01      1.160e-03      5.879e+00   
       5              9          6.654e+02      2.584e+01      2.766e-03      4.666e+00   
       6             10          6.168e+02      4.854e+01      7.697e-03      1.025e+01   
       7             11          5.873e+02      2.958e+01      1.233e-02      5.819e+00   
       8             13          5.594e+02      2.789e+01      1.923e-03      6.291e+00   
       9             15          5.449e+02      1.452e+01      1.085e-03      5.655e+00   
      10             16          5.222e+02      2.269e+01      2.250e-03      5.219e+00   
      11             18          5.126e+02      9.568e+00      1.296e-03      2.768e+00   
      12             19          5.119e+02      6.864e-01      3.594e-03      2.980e+00   
      13             20          5.076e+02      4.269e+00      8.868e-04      3.029e+00   
      14             21          5.001e+02      7.568e+00      1.787e-03      3.189e+00   
      15             22          4.845e+02      1.559e+01      3.598e-03      5.619e+00   
      16             23          4.769e+02      7.611e+00      6.006e-03      7.882e+00   
      17             24          4.517e+02      2.514e+01      1.354e-03      4.879e+00   
      18             25          4.295e+02      2.222e+01      3.562e-03      4.019e+00   
      19             26          3.828e+02      4.669e+01      8.076e-03      5.247e+00   
      20             27          2.987e+02      8.413e+01      1.533e-02      3.833e+00   
      21             28          1.758e+02      1.229e+02      2.545e-02      2.656e+00   
      22             30          1.467e+02      2.907e+01      9.831e-03      2.303e+00   
      23             31          1.046e+02      4.210e+01      1.044e-02      2.121e+00   
      24             32          8.249e+01      2.209e+01      2.358e-02      3.753e+00   
      25             33          5.724e+01      2.524e+01      9.955e-03      2.112e+00   
      26             34          4.926e+01      7.984e+00      3.445e-02      1.322e+00   
      27             35          3.798e+01      1.128e+01      2.739e-02      2.367e+00   
      28             36          1.641e+01      2.157e+01      4.207e-02      9.480e-01   
      29             38          1.329e+01      3.118e+00      2.827e-02      1.299e+00   
      30             39          1.298e+01      3.068e-01      2.418e-02      1.274e+00   
      31             40          1.060e+01      2.379e+00      1.946e-03      2.648e-01   
      32             41          9.190e+00      1.413e+00      9.750e-03      5.145e-01   
      33             42          7.423e+00      1.768e+00      2.335e-02      5.053e-01   
      34             44          6.210e+00      1.213e+00      1.219e-02      8.364e-02   
      35             46          5.856e+00      3.532e-01      5.688e-03      5.052e-01   
      36             48          5.571e+00      2.854e-01      3.403e-03      3.097e-01   
      37             49          5.512e+00      5.896e-02      6.776e-03      8.921e-01   
      38             50          5.094e+00      4.177e-01      1.902e-03      7.843e-02   
      39             51          5.041e+00      5.316e-02      3.258e-03      5.858e-01   
      40             52          4.792e+00      2.491e-01      3.576e-03      4.119e-01   
      41             54          4.662e+00      1.298e-01      1.782e-03      2.277e-01   
      42             55          4.581e+00      8.088e-02      3.192e-03      5.191e-01   
      43             56          4.372e+00      2.096e-01      3.299e-03      4.010e-01   
      44             58          4.246e+00      1.254e-01      1.661e-03      2.037e-01   
      45             59          4.161e+00      8.505e-02      2.907e-03      4.592e-01   
      46             60          3.981e+00      1.805e-01      3.005e-03      3.570e-01   
      47             62          3.873e+00      1.077e-01      1.529e-03      1.729e-01   
      48             63          3.789e+00      8.394e-02      2.649e-03      3.805e-01   
      49             64          3.649e+00      1.402e-01      2.770e-03      3.130e-01   
      50             65          3.640e+00      9.020e-03      5.131e-03      6.904e-01   
      51             66          3.377e+00      2.625e-01      1.493e-03      1.332e-01   
      52             67          3.325e+00      5.232e-02      2.564e-03      3.877e-01   
      53             68          3.206e+00      1.192e-01      2.765e-03      3.020e-01   
      54             70          3.133e+00      7.311e-02      1.409e-03      1.550e-01   
      55             71          3.095e+00      3.795e-02      2.480e-03      3.503e-01   
      56             72          2.995e+00      9.979e-02      2.533e-03      2.749e-01   
      57             74          2.934e+00      6.081e-02      1.273e-03      1.575e-01   
      58             75          2.896e+00      3.860e-02      2.227e-03      3.312e-01   
      59             76          2.805e+00      9.029e-02      2.337e-03      2.519e-01   
      60             78          2.749e+00      5.594e-02      1.229e-03      9.809e-02   
      61             79          2.723e+00      2.677e-02      2.072e-03      2.964e-01   
      62             80          2.650e+00      7.227e-02      2.193e-03      2.217e-01   
      63             81          2.614e+00      3.664e-02      3.717e-03      4.311e-01   
      64             82          2.475e+00      1.390e-01      3.621e-03      2.762e-01   
      65             84          2.401e+00      7.338e-02      1.835e-03      9.839e-02   
      66             85          2.365e+00      3.613e-02      2.878e-03      3.042e-01   
      67             86          2.274e+00      9.149e-02      2.962e-03      1.942e-01   
      68             87          2.263e+00      1.044e-02      4.706e-03      4.358e-01   
      69             88          2.128e+00      1.348e-01      2.022e-03      4.903e-02   
      70             89          2.113e+00      1.483e-02      3.178e-03      3.085e-01   
      71             90          2.055e+00      5.858e-02      1.130e-03      1.311e-02   
      72             91          2.040e+00      1.479e-02      1.659e-03      1.935e-01   
      73             92          2.002e+00      3.820e-02      1.695e-03      1.264e-01   
      74             93          1.985e+00      1.656e-02      2.607e-03      2.645e-01   
      75             94          1.901e+00      8.483e-02      2.285e-03      7.831e-02   
      76             95          1.841e+00      5.982e-02      3.345e-03      2.597e-01   
      77             96          1.707e+00      1.338e-01      3.285e-03      1.335e-01   
      78             98          1.629e+00      7.806e-02      1.670e-03      1.241e-01   
      79             99          1.546e+00      8.310e-02      2.954e-03      1.740e-01   
      80             100         1.497e+00      4.904e-02      3.354e-03      2.550e-01   
      81             101         1.415e+00      8.223e-02      2.293e-03      3.515e-01   
      82             102         1.285e+00      1.299e-01      2.317e-03      3.193e-01   
      83             104         1.171e+00      1.141e-01      8.868e-04      2.940e-02   
      84             105         1.132e+00      3.860e-02      1.822e-03      9.834e-02   
      85             106         1.105e+00      2.717e-02      2.212e-03      2.050e-01   
      86             107         1.029e+00      7.584e-02      1.910e-03      1.340e-01   
      87             108         9.751e-01      5.378e-02      3.514e-03      2.818e-01   
      88             109         8.324e-01      1.427e-01      3.817e-03      1.617e-01   
      89             111         7.604e-01      7.203e-02      2.306e-03      7.153e-02   
      90             113         7.336e-01      2.683e-02      1.138e-03      4.383e-02   
      91             114         7.049e-01      2.869e-02      1.898e-03      1.175e-01   
      92             115         6.694e-01      3.550e-02      1.720e-03      9.016e-02   
      93             116         6.529e-01      1.650e-02      1.366e-03      8.917e-02   
      94             118         6.292e-01      2.366e-02      3.605e-04      1.023e-02   
      95             119         6.181e-01      1.110e-02      5.618e-04      4.695e-02   
      96             120         6.067e-01      1.146e-02      5.902e-04      4.254e-02   
      97             122         6.002e-01      6.444e-03      1.859e-04      1.020e-02   
      98             123         5.926e-01      7.658e-03      2.685e-04      3.196e-02   
      99             125         5.874e-01      5.174e-03      1.592e-04      1.449e-02   
      100            126         5.804e-01      6.971e-03      2.708e-04      3.496e-02   
      101            128         5.755e-01      4.920e-03      1.668e-04      1.415e-02   
      102            129         5.691e-01      6.397e-03      2.749e-04      3.657e-02   
      103            130         5.667e-01      2.440e-03      5.571e-04      5.158e-02   
      104            131         5.605e-01      6.157e-03      2.089e-04      4.971e-03   
      105            132         5.547e-01      5.801e-03      2.476e-04      3.233e-02   
      106            133         5.530e-01      1.739e-03      4.907e-04      4.419e-02   
      107            134         5.474e-01      5.631e-03      1.837e-04      5.048e-03   
      108            135         5.416e-01      5.777e-03      2.064e-04      2.698e-02   
      109            136         5.390e-01      2.574e-03      4.106e-04      3.491e-02   
      110            137         5.339e-01      5.116e-03      1.474e-04      5.451e-03   
      111            138         5.280e-01      5.934e-03      1.536e-04      1.988e-02   
      112            140         5.242e-01      3.745e-03      9.523e-05      6.253e-03   
      113            141         5.175e-01      6.671e-03      1.467e-04      2.159e-02   
      114            142         5.113e-01      6.215e-03      3.136e-04      2.436e-02   
      115            170         5.113e-01      0.000e+00      0.000e+00      2.436e-02   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 5.113e-01
         Total delta_x: 2.653e-01
         Iterations: 115
         Function evaluations: 170
         Jacobian evaluations: 115
Timer: Solution time = 6.65 min
Timer: Avg time per step = 3.44 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      7.788e+02  -->   5.113e-01, 
Maximum absolute Quasi-symmetry (1,0) two-term error:        3.034e-01  -->   1.094e-01 (T^3)
Minimum absolute Quasi-symmetry (1,0) two-term error:        2.375e-05  -->   6.673e-05 (T^3)
Average absolute Quasi-symmetry (1,0) two-term error:        5.504e-02  -->   1.923e-02 (T^3)
Aspect ratio:                                                6.037e+00  -->   6.000e+00 (dimensionless)
Plasma volume:                                               5.420e-01  -->   5.841e-01 (m^3)
Maximum Rotational transform:                                2.750e-02  -->   4.199e-01 (dimensionless)
Minimum Rotational transform:                                2.745e-02  -->   4.161e-01 (dimensionless)
Average Rotational transform:                                2.749e-02  -->   4.185e-01 (dimensionless)
Maximum absolute Force error:                                6.082e-01  -->   2.443e+00 (N)
Minimum absolute Force error:                                3.191e-05  -->   4.090e-06 (N)
Average absolute Force error:                                5.827e-02  -->   4.356e-02 (N)
Maximum absolute Force error:                                2.953e-07  -->   1.186e-06 (normalized)
Minimum absolute Force error:                                1.549e-11  -->   1.986e-12 (normalized)
Average absolute Force error:                                2.829e-08  -->   2.115e-08 (normalized)
Cross-section R error:                                       0.000e+00  -->   0.000e+00 (m)
Cross-section Z error:                                       0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

