/home/ye2698/DESC/desc/integrals/_interp_utils.py:19: UserWarning: 
jax-finufft is not installed.
If you want to use NUFFTs, follow the DESC installation instructions.
Otherwise you must set the parameter nufft_eps to zero
when computing effective ripple, Gamma_c, and any other
computations that involve bounce integrals.

  warnings.warn(
DESC version=0.15.0+424.gdbba9ba17.
Using JAX backend: jax version=0.6.2, jaxlib version=0.6.2, dtype=float64.
Using device: NVIDIA A100-PCIE-40GB (id=0), with 40.00 GB available memory.
Building objective: QS two-term
Precomputing transforms
Timer: Precomputing transforms = 336 ms
Building objective: aspect ratio
Precomputing transforms
Timer: Precomputing transforms = 40.1 ms
Building objective: volume
Precomputing transforms
Timer: Precomputing transforms = 39.5 ms
Building objective: rotational transform
Precomputing transforms
Timer: Precomputing transforms = 296 ms
Timer: Objective build = 800 ms
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 527 ms
Timer: Objective build = 843 ms
Timer: Objective build = 3.07 ms
Timer: Eq Update LinearConstraintProjection build = 2.25 sec
Timer: Proximal projection build = 10.4 sec
Building objective: fixed cross-section R
Building objective: fixed cross-section Z
Building objective: fixed pressure
Building objective: fixed current
Building objective: fixed Psi
Timer: Objective build = 286 ms
Timer: LinearConstraintProjection build = 833 ms
Number of parameters: 45
Number of objectives: 478
Timer: Initializing the optimization = 11.6 sec

Starting optimization
Using method: proximal-lsq-exact
Solver options:
------------------------------------------------------------
Maximum Function Evaluations       : 1251
Maximum Allowed Total Î”x Norm      : inf
Scaled Termination                 : True
Trust Region Method                : qr
Initial Trust Radius               : 1.314e+02
Maximum Trust Radius               : inf
Minimum Trust Radius               : 2.220e-16
Trust Radius Increase Ratio        : 2.000e+00
Trust Radius Decrease Ratio        : 2.500e-01
Trust Radius Increase Threshold    : 7.500e-01
Trust Radius Decrease Threshold    : 2.500e-01
------------------------------------------------------------ 

   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality   
       0              1          1.248e+03                                    1.438e+01   
       1              4          1.156e+03      9.125e+01      2.825e-03      8.371e+00   
       2              5          1.073e+03      8.382e+01      6.433e-03      4.336e+00   
       3              6          1.033e+03      3.929e+01      1.809e-02      7.360e+00   
       4              7          1.015e+03      1.835e+01      1.549e-02      6.824e+00   
       5              8          9.731e+02      4.188e+01      7.853e-04      3.488e+00   
       6              9          9.504e+02      2.266e+01      5.445e-03      3.657e+00   
       7             10          9.292e+02      2.122e+01      5.075e-03      1.074e+00   
       8             11          9.142e+02      1.495e+01      1.523e-02      1.514e+00   
       9             12          9.062e+02      7.998e+00      3.048e-02      4.795e+00   
      10             13          8.801e+02      2.618e+01      1.054e-02      3.281e+00   
      11             14          8.479e+02      3.216e+01      1.268e-02      1.665e+00   
      12             16          8.477e+02      1.497e-01      9.501e-03      2.618e+00   
      13             17          8.356e+02      1.214e+01      3.560e-03      8.340e-01   
      14             18          8.308e+02      4.773e+00      2.756e-03      8.727e-01   
      15             19          8.264e+02      4.431e+00      4.203e-03      1.488e+00   
      16             20          8.216e+02      4.828e+00      4.386e-03      1.675e+00   
      17             21          8.080e+02      1.352e+01      3.236e-03      1.055e+00   
      18             22          7.835e+02      2.456e+01      6.569e-03      4.334e+00   
      19             24          7.666e+02      1.684e+01      2.477e-03      1.991e+00   
      20             25          7.484e+02      1.826e+01      4.821e-03      1.731e+00   
      21             26          7.204e+02      2.803e+01      7.915e-03      2.096e+00   
      22             27          7.074e+02      1.298e+01      1.179e-02      6.400e+00   
      23             28          7.004e+02      6.977e+00      3.055e-03      2.162e+00   
      24             29          6.923e+02      8.110e+00      1.182e-03      1.002e+00   
      25             30          6.845e+02      7.763e+00      1.509e-03      1.000e+00   
      26             31          6.743e+02      1.025e+01      3.196e-03      1.073e+00   
      27             32          6.558e+02      1.848e+01      6.896e-03      9.892e-01   
      28             34          6.452e+02      1.063e+01      2.930e-03      7.282e-01   
      29             35          6.252e+02      1.998e+01      5.388e-03      8.754e-01   
      30             37          6.146e+02      1.060e+01      2.030e-03      5.666e-01   
      31             38          5.987e+02      1.586e+01      5.592e-03      1.562e+00   
      32             39          5.766e+02      2.209e+01      8.845e-03      1.477e+00   
      33             41          5.605e+02      1.613e+01      1.523e-03      1.031e+00   
      34             42          5.362e+02      2.427e+01      5.647e-03      1.291e+00   
      35             43          5.301e+02      6.139e+00      6.664e-03      7.538e+00   
      36             44          4.824e+02      4.772e+01      4.467e-04      1.772e+00   
      37             46          4.710e+02      1.134e+01      1.497e-03      1.300e+00   
      38             47          4.529e+02      1.810e+01      1.705e-03      9.451e-01   
      39             48          4.349e+02      1.799e+01      2.736e-03      1.901e+00   
      40             50          4.246e+02      1.036e+01      2.442e-03      9.642e-01   
      41             51          4.225e+02      2.091e+00      3.550e-03      2.843e+00   
      42             52          4.111e+02      1.141e+01      1.017e-03      6.660e-01   
      43             53          4.015e+02      9.538e+00      1.517e-03      9.924e-01   
      44             54          3.948e+02      6.740e+00      5.630e-03      3.619e+00   
      45             55          3.702e+02      2.463e+01      7.955e-03      1.506e+00   
      46             57          3.698e+02      3.395e-01      4.173e-03      1.748e+00   
      47             58          3.650e+02      4.867e+00      6.123e-04      5.502e-01   
      48             59          3.611e+02      3.810e+00      5.677e-04      5.863e-01   
      49             60          3.551e+02      6.080e+00      1.197e-03      8.157e-01   
      50             61          3.505e+02      4.536e+00      2.587e-03      2.614e+00   
      51             62          3.353e+02      1.528e+01      3.303e-03      1.428e+00   
      52             63          3.313e+02      3.957e+00      4.856e-03      5.782e+00   
      53             64          3.077e+02      2.356e+01      1.915e-03      1.426e+00   
      54             65          3.050e+02      2.745e+00      2.451e-03      2.876e+00   
      55             67          2.958e+02      9.219e+00      8.967e-04      1.173e+00   
      56             68          2.950e+02      7.965e-01      2.587e-03      1.369e+00   
      57             69          2.931e+02      1.900e+00      5.072e-04      5.287e-01   
      58             70          2.919e+02      1.203e+00      5.410e-04      2.195e-01   
      59             71          2.909e+02      9.624e-01      1.514e-03      3.205e-01   
      60             72          2.891e+02      1.788e+00      1.921e-03      4.925e-01   
      61             74          2.882e+02      9.033e-01      1.087e-03      3.158e-01   
      62             75          2.871e+02      1.156e+00      2.163e-03      5.966e-01   
      63             76          2.857e+02      1.360e+00      2.395e-03      6.173e-01   
      64             77          2.844e+02      1.342e+00      2.538e-03      6.710e-01   
      65             78          2.827e+02      1.669e+00      2.640e-03      7.225e-01   
      66             79          2.806e+02      2.068e+00      2.678e-03      7.466e-01   
      67             80          2.782e+02      2.399e+00      2.666e-03      7.723e-01   
      68             81          2.738e+02      4.449e+00      5.020e-03      1.494e+00   
      69             82          2.660e+02      7.739e+00      8.779e-03      2.983e+00   
      70             83          2.508e+02      1.523e+01      7.440e-03      1.429e+00   
      71             84          2.471e+02      3.750e+00      1.423e-02      3.629e+00   
      72             85          2.354e+02      1.161e+01      3.521e-03      2.063e+00   
      73             86          2.286e+02      6.814e+00      3.432e-03      7.523e-01   
      74             87          2.224e+02      6.206e+00      3.940e-03      9.177e-01   
      75             88          2.093e+02      1.316e+01      7.001e-03      1.618e+00   
      76             89          1.860e+02      2.329e+01      1.193e-02      3.120e+00   
      77             91          1.602e+02      2.576e+01      6.747e-03      2.404e+00   
      78             93          1.484e+02      1.179e+01      4.040e-03      8.883e-01   
      79             94          1.355e+02      1.296e+01      6.641e-03      2.659e+00   
      80             95          1.124e+02      2.305e+01      9.497e-03      2.091e+00   
      81             97          1.089e+02      3.555e+00      3.119e-03      3.049e+00   
      82             98          9.744e+01      1.141e+01      3.077e-03      2.076e+00   
      83             99          9.741e+01      2.432e-02      2.820e-03      1.891e+00   
      84             100         9.338e+01      4.036e+00      6.542e-04      6.663e-01   
      85             101         9.054e+01      2.841e+00      2.376e-03      5.797e-01   
      86             102         8.614e+01      4.398e+00      2.822e-03      6.197e-01   
      87             103         7.887e+01      7.273e+00      5.807e-03      8.033e-01   
      88             105         7.452e+01      4.342e+00      2.324e-03      3.460e-01   
      89             106         7.260e+01      1.928e+00      3.901e-03      1.436e+00   
      90             107         7.055e+01      2.048e+00      3.057e-03      1.053e+00   
      91             108         6.663e+01      3.915e+00      6.223e-04      4.459e-01   
      92             109         6.534e+01      1.288e+00      1.390e-03      7.255e-01   
      93             110         6.204e+01      3.305e+00      1.514e-03      6.209e-01   
      94             111         6.033e+01      1.712e+00      2.565e-03      1.721e+00   
      95             112         5.378e+01      6.544e+00      2.137e-03      8.695e-01   
      96             114         5.107e+01      2.710e+00      1.170e-03      1.515e-01   
      97             115         4.792e+01      3.156e+00      1.348e-03      7.404e-01   
      98             116         4.372e+01      4.195e+00      1.973e-03      2.235e+00   
      99             118         4.063e+01      3.093e+00      7.503e-04      1.579e+00   
      100            119         3.836e+01      2.271e+00      3.762e-04      1.332e+00   
      101            120         3.560e+01      2.759e+00      3.327e-04      5.059e-01   
      102            122         3.477e+01      8.247e-01      2.182e-04      4.511e-01   
      103            123         3.409e+01      6.869e-01      2.623e-04      4.351e-01   
      104            124         3.343e+01      6.557e-01      3.705e-04      4.495e-01   
      105            125         3.280e+01      6.275e-01      4.714e-04      4.702e-01   
      106            126         3.171e+01      1.088e+00      5.648e-04      1.680e-01   
      107            127         3.108e+01      6.375e-01      1.259e-03      4.914e-01   
      108            128         2.999e+01      1.084e+00      1.194e-03      5.440e-01   
      109            129         2.914e+01      8.541e-01      1.023e-03      6.350e-01   
      110            130         2.821e+01      9.300e-01      9.865e-04      6.353e-01   
      111            131         2.726e+01      9.464e-01      9.965e-04      5.726e-01   
      112            133         2.641e+01      8.540e-01      2.728e-04      1.279e-01   
      113            135         2.630e+01      1.085e-01      1.387e-04      9.741e-02   
      114            136         2.620e+01      1.006e-01      1.533e-04      1.055e-01   
      115            137         2.599e+01      2.065e-01      3.150e-04      1.474e-01   
      116            138         2.596e+01      3.497e-02      6.061e-04      5.222e-01   
      117            139         2.558e+01      3.741e-01      1.413e-04      9.769e-02   
      118            140         2.538e+01      2.012e-01      3.311e-04      1.653e-01   
      119            141         2.532e+01      6.317e-02      6.319e-04      5.459e-01   
      120            142         2.497e+01      3.451e-01      1.625e-04      9.285e-02   
      121            143         2.479e+01      1.823e-01      3.527e-04      1.850e-01   
      122            144         2.475e+01      4.688e-02      6.402e-04      5.794e-01   
      123            145         2.441e+01      3.359e-01      1.776e-04      8.399e-02   
      124            146         2.426e+01      1.519e-01      3.563e-04      2.069e-01   
      125            148         2.417e+01      8.910e-02      1.746e-04      1.128e-01   
      126            149         2.404e+01      1.308e-01      3.310e-04      2.228e-01   
      127            151         2.394e+01      1.014e-01      1.645e-04      7.120e-02   
      128            152         2.383e+01      1.050e-01      2.952e-04      2.373e-01   
      129            154         2.373e+01      9.780e-02      1.497e-04      6.994e-02   
      130            155         2.365e+01      8.701e-02      2.630e-04      2.450e-01   
      131            157         2.355e+01      9.258e-02      1.378e-04      6.759e-02   
      132            158         2.348e+01      7.095e-02      2.411e-04      2.474e-01   
      133            159         2.338e+01      1.069e-01      2.430e-04      2.013e-01   
      134            161         2.331e+01      7.029e-02      1.315e-04      7.730e-02   
      135            162         2.325e+01      5.539e-02      2.314e-04      2.222e-01   
      136            163         2.316e+01      8.605e-02      2.453e-04      1.826e-01   
      137            164         2.308e+01      8.476e-02      4.773e-04      3.534e-01   
      138            165         2.291e+01      1.724e-01      5.245e-04      2.407e-01   
      139            167         2.281e+01      9.580e-02      2.802e-04      8.402e-02   
      140            168         2.275e+01      6.459e-02      5.027e-04      2.782e-01   
      141            169         2.261e+01      1.375e-01      5.256e-04      2.009e-01   
      142            171         2.253e+01      7.870e-02      2.746e-04      7.190e-02   
      143            172         2.246e+01      6.596e-02      4.830e-04      2.397e-01   
      144            173         2.234e+01      1.199e-01      4.855e-04      1.846e-01   
      145            174         2.225e+01      9.299e-02      4.594e-04      2.066e-01   
      146            175         2.215e+01      1.063e-01      4.361e-04      1.834e-01   
      147            176         2.204e+01      1.004e-01      4.082e-04      1.836e-01   
      148            177         2.194e+01      1.055e-01      3.826e-04      1.705e-01   
      149            178         2.183e+01      1.061e-01      3.571e-04      1.637e-01   
      150            179         2.172e+01      1.095e-01      3.338e-04      1.535e-01   
      151            181         2.166e+01      6.094e-02      1.799e-04      1.115e-01   
      152            182         2.162e+01      4.743e-02      1.531e-04      1.152e-01   
      153            183         2.156e+01      5.094e-02      1.425e-04      1.152e-01   
      154            184         2.151e+01      5.004e-02      1.374e-04      1.153e-01   
      155            185         2.146e+01      5.118e-02      1.324e-04      1.171e-01   
      156            186         2.141e+01      5.146e-02      1.287e-04      1.176e-01   
      157            187         2.136e+01      5.210e-02      1.250e-04      1.184e-01   
      158            188         2.131e+01      5.256e-02      1.215e-04      1.186e-01   
      159            189         2.125e+01      5.305e-02      1.180e-04      1.188e-01   
      160            190         2.118e+01      7.685e-02      1.143e-04      3.691e-02   
      161            191         2.108e+01      9.810e-02      1.900e-04      1.693e-01   
      162            193         2.099e+01      9.330e-02      1.220e-04      3.384e-02   
      163            194         2.089e+01      1.006e-01      1.772e-04      1.670e-01   
      164            196         2.079e+01      9.318e-02      1.107e-04      4.231e-02   
      165            197         2.069e+01      1.035e-01      1.607e-04      1.670e-01   
      166            199         2.060e+01      9.327e-02      9.810e-05      4.948e-02   
      167            200         2.049e+01      1.061e-01      1.447e-04      1.669e-01   
      168            202         2.040e+01      9.388e-02      8.666e-05      5.641e-02   
      169            203         2.029e+01      1.092e-01      1.307e-04      1.658e-01   
      170            205         2.019e+01      9.511e-02      7.691e-05      6.417e-02   
      171            206         2.008e+01      1.122e-01      1.187e-04      1.644e-01   
      172            208         1.998e+01      9.736e-02      6.881e-05      7.281e-02   
      173            209         1.987e+01      1.148e-01      1.088e-04      1.632e-01   
      174            211         1.977e+01      1.013e-01      6.238e-05      8.170e-02   
      175            212         1.965e+01      1.158e-01      1.012e-04      1.637e-01   
      176            214         1.954e+01      1.083e-01      5.822e-05      8.958e-02   
      177            215         1.943e+01      1.148e-01      9.723e-05      1.855e-01   
      178            216         1.927e+01      1.537e-01      1.039e-04      1.941e-01   
      179            218         1.915e+01      1.199e-01      5.657e-05      1.048e-01   
      180            219         1.904e+01      1.125e-01      1.050e-04      2.408e-01   
      181            220         1.886e+01      1.782e-01      1.146e-04      2.186e-01   
      182            222         1.875e+01      1.128e-01      6.348e-05      9.134e-02   
      183            223         1.863e+01      1.167e-01      1.259e-04      2.709e-01   
      184            224         1.857e+01      6.045e-02      1.428e-04      3.272e-01   
      185            225         1.841e+01      1.617e-01      5.584e-05      5.327e-02   
      186            226         1.833e+01      7.807e-02      8.203e-05      1.268e-01   
      187            227         1.822e+01      1.155e-01      8.924e-05      9.775e-02   
      188            228         1.819e+01      2.367e-02      1.730e-04      3.959e-01   
      189            229         1.799e+01      2.059e-01      6.058e-05      4.624e-02   
      190            230         1.787e+01      1.147e-01      8.274e-05      1.261e-01   
      191            231         1.778e+01      9.705e-02      1.917e-04      4.027e-01   
      192            232         1.763e+01      1.459e-01      2.068e-04      5.125e-01   
      193            233         1.733e+01      2.991e-01      2.432e-04      4.658e-01   
      194            234         1.698e+01      3.529e-01      2.836e-04      4.399e-01   
      195            235         1.665e+01      3.319e-01      3.124e-04      5.020e-01   
      196            236         1.659e+01      5.562e-02      3.255e-04      6.031e-01   
      197            237         1.614e+01      4.528e-01      1.498e-04      1.422e-01   
      198            238         1.597e+01      1.676e-01      1.262e-04      8.597e-02   
      199            240         1.588e+01      8.757e-02      7.018e-05      3.925e-02   
      200            241         1.576e+01      1.271e-01      1.986e-04      1.330e-01   
      201            242         1.555e+01      2.078e-01      3.529e-04      3.843e-01   
      202            244         1.537e+01      1.821e-01      1.801e-04      1.862e-01   
      203            245         1.518e+01      1.878e-01      2.981e-04      3.725e-01   
      204            247         1.501e+01      1.630e-01      1.477e-04      1.745e-01   
      205            248         1.484e+01      1.737e-01      2.861e-04      3.305e-01   
      206            250         1.471e+01      1.357e-01      1.385e-04      1.619e-01   
      207            251         1.454e+01      1.636e-01      2.904e-04      2.910e-01   
      208            253         1.443e+01      1.138e-01      1.409e-04      1.524e-01   
      209            254         1.427e+01      1.562e-01      2.965e-04      2.591e-01   
      210            257         1.424e+01      2.776e-02      3.807e-05      8.315e-02   
      211            284         1.424e+01      0.000e+00      0.000e+00      8.315e-02   
Warning: A bad approximation caused failure to predict improvement.
         Current function value: 1.424e+01
         Total delta_x: 2.596e-01
         Iterations: 211
         Function evaluations: 284
         Jacobian evaluations: 211
Timer: Solution time = 9.90 min
Timer: Avg time per step = 2.80 sec
==============================================================================================================
                                                                 Start  -->   End
Total (sum of squares):                                      1.245e+03  -->   1.424e+01, 
Maximum absolute Quasi-symmetry (1,0) two-term error:        3.034e-01  -->   9.437e-02 (T^3)
Minimum absolute Quasi-symmetry (1,0) two-term error:        2.375e-05  -->   4.334e-05 (T^3)
Average absolute Quasi-symmetry (1,0) two-term error:        5.504e-02  -->   9.854e-03 (T^3)
Aspect ratio:                                                6.037e+00  -->   5.999e+00 (dimensionless)
Plasma volume:                                               5.420e-01  -->   6.137e-01 (m^3)
Maximum Rotational transform:                                2.750e-02  -->   4.111e-01 (dimensionless)
Minimum Rotational transform:                                2.745e-02  -->   4.011e-01 (dimensionless)
Average Rotational transform:                                2.749e-02  -->   4.074e-01 (dimensionless)
Maximum absolute Force error:                                6.082e-01  -->   1.770e+00 (N)
Minimum absolute Force error:                                3.191e-05  -->   5.410e-06 (N)
Average absolute Force error:                                5.827e-02  -->   3.386e-02 (N)
Maximum absolute Force error:                                2.953e-07  -->   8.593e-07 (normalized)
Minimum absolute Force error:                                1.549e-11  -->   2.626e-12 (normalized)
Average absolute Force error:                                2.829e-08  -->   1.644e-08 (normalized)
Cross-section R error:                                       0.000e+00  -->   0.000e+00 (m)
Cross-section Z error:                                       0.000e+00  -->   0.000e+00 (m)
Fixed pressure profile error:                                0.000e+00  -->   0.000e+00 (Pa)
Fixed current profile error:                                 0.000e+00  -->   0.000e+00 (A)
Fixed Psi error:                                             0.000e+00  -->   0.000e+00 (Wb)
==============================================================================================================

