DESC version=0.15.0+581.gc92af1c78.
Using JAX backend: jax version=0.7.2, jaxlib version=0.7.2, dtype=float64.
Using device: NVIDIA A100 80GB PCIe (id=0), with 80.00 GB available memory.
=========== Optimizing with modes  > 1 ===========
Building objective: Particle Confinement
Precomputing transforms
Timer: Precomputing transforms = 4.27 sec
Building objective: aspect ratio
Precomputing transforms
Timer: Precomputing transforms = 45.4 ms
Building objective: elongation
Precomputing transforms
Timer: Precomputing transforms = 44.7 ms
Timer: Objective build = 10.2 sec
Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 1.33 sec
Timer: Objective build = 2.07 sec
Timer: Objective build = 2.49 ms
Timer: Eq Update LinearConstraintProjection build = 8.58 sec
Timer: Proximal projection build = 41.2 sec
Building objective: fixed pressure
Building objective: fixed Psi
Building objective: fixed current
Building objective: lcfs R
Building objective: lcfs Z
Timer: Objective build = 1.04 sec
Timer: LinearConstraintProjection build = 2.38 sec
Number of parameters: 8
Number of objectives: 1002
Timer: Initializing the optimization = 44.7 sec

Starting optimization
Using method: proximal-lsq-exact
Traceback (most recent call last):
  File "/home/ye2698/DESC/DEBUG/Particle_Tracing/Optimization/optimization-with-fit.py", line 373, in <module>
    eq.optimize(
  File "/home/ye2698/DESC/desc/equilibrium/equilibrium.py", line 2394, in optimize
    things, result = optimizer.optimize(
                     ^^^^^^^^^^^^^^^^^^^
  File "/home/ye2698/DESC/desc/optimize/optimizer.py", line 278, in optimize
    result = optimizers[method]["fun"](
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ye2698/DESC/desc/optimize/_desc_wrappers.py", line 270, in _optimize_desc_least_squares
    result = lsqtr(
             ^^^^^^
  File "/home/ye2698/DESC/desc/optimize/least_squares.py", line 178, in lsqtr
    f = fun(x, *args)
        ^^^^^^^^^^^^^
  File "/home/ye2698/DESC/desc/optimize/_constraint_wrappers.py", line 320, in compute_scaled_error
    f = self._objective.compute_scaled_error(x, constants)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ye2698/DESC/desc/optimize/_constraint_wrappers.py", line 1001, in compute_scaled_error
    return self._objective.compute_scaled_error(xopt, constants[0])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ye2698/DESC/desc/objectives/objective_funs.py", line 538, in compute_scaled_error
    obj.compute_scaled_error(*par, constants=const)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ye2698/DESC/desc/objectives/objective_funs.py", line 1284, in compute_scaled_error
    f = self.compute(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ye2698/DESC/DEBUG/Particle_Tracing/Optimization/optimization-with-fit.py", line 259, in compute
    self._interpolator.fit(params, {"iota": iota_prof})
  File "/home/ye2698/DESC/desc/particles.py", line 1373, in fit
    "Br": data_raw["B"][:, 0].reshape(N, L, M),
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ye2698/.conda/envs/desc-env/lib/python3.12/site-packages/jax/_src/numpy/array_methods.py", line 1147, in meth
    return getattr(self.aval, name).fun(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ye2698/.conda/envs/desc-env/lib/python3.12/site-packages/jax/_src/numpy/array_methods.py", line 316, in _reshape
    newshape = _compute_newshape(self, args[0] if len(args) == 1 else args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ye2698/.conda/envs/desc-env/lib/python3.12/site-packages/jax/_src/numpy/array_methods.py", line 457, in _compute_newshape
    newshape = core.canonicalize_shape(newshape)  # type: ignore[arg-type]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Shapes must be 1D sequences of concrete values of integer type, got (JitTracer<~int64[]>, 16, JitTracer<~int64[]>).
If using `jit`, try using `static_argnums` or applying `jit` to smaller subfunctions.
The error occurred while tracing the function compute_scaled_error at /home/ye2698/DESC/desc/objectives/objective_funs.py:1280 for jit. This concrete value was not available in Python because it depends on the value of the argument self[0]['_interpolator'][0]['N_fft'].
The error occurred while tracing the function compute_scaled_error at /home/ye2698/DESC/desc/objectives/objective_funs.py:1280 for jit. This concrete value was not available in Python because it depends on the value of the argument self[0]['_interpolator'][0]['M_fft'].
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
